<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>FabStudio: software/projects/apps/FabStudio/mainwindow.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<h1>software/projects/apps/FabStudio/mainwindow.cpp</h1><a href="mainwindow_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*---------------------------------------------------------------------------*\</span>
<a name="l00002"></a>00002 <span class="comment"> This file is part of the Fab@Home Project.</span>
<a name="l00003"></a>00003 <span class="comment"> Fab@Home operates under the BSD Open Source License.</span>
<a name="l00004"></a>00004 <span class="comment"></span>
<a name="l00005"></a>00005 <span class="comment"> Copyright (c) 2010, Karl Gluck (kwg8@cornell.edu)</span>
<a name="l00006"></a>00006 <span class="comment"></span>
<a name="l00007"></a>00007 <span class="comment"> All rights reserved.</span>
<a name="l00008"></a>00008 <span class="comment"></span>
<a name="l00009"></a>00009 <span class="comment"> Redistribution and use in source and binary forms, with or without</span>
<a name="l00010"></a>00010 <span class="comment"> modification, are permitted provided that the following conditions are met:</span>
<a name="l00011"></a>00011 <span class="comment">     * Redistributions of source code must retain the above copyright</span>
<a name="l00012"></a>00012 <span class="comment">       notice, this list of conditions and the following disclaimer.</span>
<a name="l00013"></a>00013 <span class="comment">     * Redistributions in binary form must reproduce the above copyright</span>
<a name="l00014"></a>00014 <span class="comment">       notice, this list of conditions and the following disclaimer in the</span>
<a name="l00015"></a>00015 <span class="comment">       documentation and/or other materials provided with the distribution.</span>
<a name="l00016"></a>00016 <span class="comment">     * Neither the name of the &lt;organization&gt; nor the</span>
<a name="l00017"></a>00017 <span class="comment">       names of its contributors may be used to endorse or promote products</span>
<a name="l00018"></a>00018 <span class="comment">       derived from this software without specific prior written permission.</span>
<a name="l00019"></a>00019 <span class="comment"></span>
<a name="l00020"></a>00020 <span class="comment"> THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;</span>
<a name="l00021"></a>00021 <span class="comment"> AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
<a name="l00022"></a>00022 <span class="comment"> IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span>
<a name="l00023"></a>00023 <span class="comment"> DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNERS OR CONTRIBUTORS BE LIABLE</span>
<a name="l00024"></a>00024 <span class="comment"> FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span>
<a name="l00025"></a>00025 <span class="comment"> DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span>
<a name="l00026"></a>00026 <span class="comment"> SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER</span>
<a name="l00027"></a>00027 <span class="comment"> CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,</span>
<a name="l00028"></a>00028 <span class="comment"> OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<a name="l00029"></a>00029 <span class="comment"> OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00030"></a>00030 <span class="comment">\*---------------------------------------------------------------------------*/</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &quot;<a class="code" href="mainwindow_8h.html">mainwindow.h</a>&quot;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &quot;<a class="code" href="ui__mainwindow_8h.html">ui_mainwindow.h</a>&quot;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &quot;<a class="code" href="openglwidget_8h.html">openglwidget.h</a>&quot;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &quot;<a class="code" href="openglcamera_8h.html">openglcamera.h</a>&quot;</span>
<a name="l00035"></a>00035 
<a name="l00036"></a>00036 <span class="preprocessor">#include &quot;<a class="code" href="toolbar_8h.html">toolbar.h</a>&quot;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &quot;<a class="code" href="loadobjectspanel_8h.html">loadobjectspanel.h</a>&quot;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &quot;<a class="code" href="positionobjectspanel_8h.html">positionobjectspanel.h</a>&quot;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &quot;<a class="code" href="printableobject_8h.html">printableobject.h</a>&quot;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &quot;<a class="code" href="loadobjectfilethread_8h.html">loadobjectfilethread.h</a>&quot;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &quot;<a class="code" href="printpanel_8h.html">printpanel.h</a>&quot;</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include &quot;<a class="code" href="materialspanel_8h.html">materialspanel.h</a>&quot;</span>
<a name="l00043"></a>00043 <span class="preprocessor">#include &quot;<a class="code" href="openglrenderprimitives_8h.html">openglrenderprimitives.h</a>&quot;</span> <span class="comment">// used to render the ground grid</span>
<a name="l00044"></a>00044 
<a name="l00045"></a>00045 <span class="preprocessor">#include &lt;QToolBar&gt;</span>
<a name="l00046"></a>00046 <span class="preprocessor">#include &lt;QDebug&gt;</span>
<a name="l00047"></a>00047 
<a name="l00048"></a>00048 <span class="preprocessor">#include &lt;QDragEnterEvent&gt;</span>
<a name="l00049"></a>00049 <span class="preprocessor">#include &lt;QSettings&gt;</span>
<a name="l00050"></a>00050 
<a name="l00051"></a>00051 <span class="comment">// for opening web browser</span>
<a name="l00052"></a>00052 <span class="preprocessor">#include &lt;QDesktopServices&gt;</span>
<a name="l00053"></a>00053 <span class="preprocessor">#include &lt;QUrl&gt;</span>
<a name="l00054"></a>00054 
<a name="l00055"></a>00055 <span class="preprocessor">#include &quot;<a class="code" href="slicer_8h.html">shared/slicer/slicer.h</a>&quot;</span>
<a name="l00056"></a>00056 <span class="preprocessor">#include &quot;<a class="code" href="arrangebuildtray_8h.html">arrangebuildtray.h</a>&quot;</span>
<a name="l00057"></a>00057 <span class="preprocessor">#include &quot;<a class="code" href="firstexecutiondialog_8h.html">firstexecutiondialog.h</a>&quot;</span>
<a name="l00058"></a>00058 <span class="preprocessor">#include &quot;<a class="code" href="aboutdialog_8h.html">aboutdialog.h</a>&quot;</span>
<a name="l00059"></a>00059 
<a name="l00060"></a><a class="code" href="mainwindow_8cpp.html#acad3eb6382b41bd0fad76b7afa427b8d">00060</a> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="mainwindow_8cpp.html#acad3eb6382b41bd0fad76b7afa427b8d">kAdvancedModeSettingKey</a>[] = <span class="stringliteral">&quot;advanced_mode&quot;</span>;
<a name="l00061"></a><a class="code" href="mainwindow_8cpp.html#a18c4d0bf5dbe1f9fe1f3f142714f582f">00061</a> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="mainwindow_8cpp.html#a18c4d0bf5dbe1f9fe1f3f142714f582f">kFirstExecutionSettingKey</a>[] = <span class="stringliteral">&quot;first_exec&quot;</span>;
<a name="l00062"></a><a class="code" href="mainwindow_8cpp.html#a30721e11c6fda03a29293f88e2354778">00062</a> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="mainwindow_8cpp.html#a30721e11c6fda03a29293f88e2354778">kAlwaysShowStartupInformationSettingKey</a>[] = <span class="stringliteral">&quot;always_show_startup&quot;</span>;
<a name="l00063"></a>00063 
<a name="l00064"></a>00064 
<a name="l00065"></a><a class="code" href="class_main_window.html#a8b244be8b7b7db1b08de2a2acb9409db">00065</a> <a class="code" href="class_main_window.html#a8b244be8b7b7db1b08de2a2acb9409db">MainWindow::MainWindow</a>(QWidget *parent)
<a name="l00066"></a>00066     : QMainWindow(parent),
<a name="l00067"></a>00067       ui(new Ui::<a class="code" href="class_main_window.html">MainWindow</a>),
<a name="l00068"></a>00068       opengl_widget_(0),
<a name="l00069"></a>00069       load_objects_panel_(0),
<a name="l00070"></a>00070       position_objects_panel_(0),
<a name="l00071"></a>00071       print_panel_(0),
<a name="l00072"></a>00072       materials_panel_(0),
<a name="l00073"></a>00073       selected_object_(0),
<a name="l00074"></a>00074       load_object_file_thread_(0)
<a name="l00075"></a>00075 {
<a name="l00076"></a>00076 
<a name="l00077"></a>00077   <span class="comment">// Initialize the main window&#39;s settings</span>
<a name="l00078"></a>00078   <a class="code" href="class_main_window.html#a35466a70ed47252a0191168126a352a5">ui</a>-&gt;<a class="code" href="class_ui___main_window.html#acf4a0872c4c77d8f43a2ec66ed849b58">setupUi</a>(<span class="keyword">this</span>);
<a name="l00079"></a>00079   setWindowTitle(<span class="stringliteral">&quot;Fab Studio&quot;</span>);
<a name="l00080"></a>00080 
<a name="l00081"></a>00081   <span class="comment">// Receive key press events</span>
<a name="l00082"></a>00082   setFocusPolicy(Qt::StrongFocus);
<a name="l00083"></a>00083 
<a name="l00084"></a>00084   { <span class="comment">// Add the toolbar to the top of the window</span>
<a name="l00085"></a>00085     QToolBar* qtb = this-&gt;addToolBar(<span class="stringliteral">&quot;Toolbar&quot;</span>);
<a name="l00086"></a>00086     qtb-&gt;addWidget(<a class="code" href="class_main_window.html#ae33c89fc0b34d28d8a7c22e9f06d2f2d" title="Provides a breadcrumb of buttons.">toolbar_</a> = <span class="keyword">new</span> <a class="code" href="class_toolbar.html">Toolbar</a>(<span class="keyword">this</span>));
<a name="l00087"></a>00087     qtb-&gt;setAllowedAreas(Qt::BottomToolBarArea | Qt::TopToolBarArea);
<a name="l00088"></a>00088   }
<a name="l00089"></a>00089 
<a name="l00090"></a>00090   <span class="comment">// Add all of the panels, then hide them until they&#39;re needed</span>
<a name="l00091"></a>00091   this-&gt;setDockOptions(QMainWindow::ForceTabbedDocks);
<a name="l00092"></a>00092   QList&lt;QDockWidget*&gt; dock_widgets;
<a name="l00093"></a>00093   dock_widgets.append(<a class="code" href="class_main_window.html#ae63126f188819c07771852e0a4b91f6b" title="Provides ways of bringing objects into the scene.">load_objects_panel_</a> = <span class="keyword">new</span> <a class="code" href="class_load_objects_panel.html">LoadObjectsPanel</a>());
<a name="l00094"></a>00094   dock_widgets.append(<a class="code" href="class_main_window.html#adfab654511e443d02a0adc2d1910851c" title="Allows objects to be reoriented.">position_objects_panel_</a> = <span class="keyword">new</span> <a class="code" href="class_position_objects_panel.html">PositionObjectsPanel</a>(<span class="keyword">this</span>));
<a name="l00095"></a>00095   dock_widgets.append(<a class="code" href="class_main_window.html#a7542af37381cff5cf5720f9e825938cd" title="Handles slicing/pathing/toolscript.">print_panel_</a> = <span class="keyword">new</span> <a class="code" href="class_print_panel.html">PrintPanel</a>(<span class="keyword">this</span>));
<a name="l00096"></a>00096   dock_widgets.append(<a class="code" href="class_main_window.html#ab2b954f1b53302af498f9f83948f3fa5" title="Allows objects to be given printing materials.">materials_panel_</a> = <span class="keyword">new</span> <a class="code" href="class_materials_panel.html">MaterialsPanel</a>(<span class="keyword">this</span>));
<a name="l00097"></a>00097 
<a name="l00098"></a>00098   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; dock_widgets.size(); ++i) {
<a name="l00099"></a>00099     QDockWidget* widget = dock_widgets.at(i);
<a name="l00100"></a>00100     addDockWidget(Qt::RightDockWidgetArea, widget);
<a name="l00101"></a>00101 
<a name="l00102"></a>00102     <span class="comment">// Add an action to the view menu that will display this widget</span>
<a name="l00103"></a>00103     QAction* action = <a class="code" href="class_main_window.html#a35466a70ed47252a0191168126a352a5">ui</a>-&gt;<a class="code" href="class_ui___main_window.html#a9e7f2ce6c3d8a309109baed7d6890604">menuView</a>-&gt;addAction(widget-&gt;windowTitle());
<a name="l00104"></a>00104     QString key_sequence;
<a name="l00105"></a>00105     QTextStream(&amp;key_sequence) &lt;&lt; <span class="stringliteral">&quot;Ctrl+&quot;</span> &lt;&lt; widget-&gt;windowTitle().at(0);
<a name="l00106"></a>00106     action-&gt;setShortcut(QKeySequence(key_sequence));
<a name="l00107"></a>00107     connect(action,SIGNAL(triggered()),widget,SLOT(show()));
<a name="l00108"></a>00108     connect(action,SIGNAL(triggered()),widget,SLOT(<span class="keyword">raise</span>()));
<a name="l00109"></a>00109 
<a name="l00110"></a>00110     <a class="code" href="todo_8h.html#ae61a00cdcabcd21f703f7ad228eb25db">todo</a>(<span class="stringliteral">&quot;kwg8&quot;</span>, <span class="stringliteral">&quot;add the ability to detect when a dock widget is closed and update the screen!&quot;</span>);
<a name="l00111"></a>00111 
<a name="l00112"></a>00112     <span class="keywordflow">if</span> (i &gt; 0) {
<a name="l00113"></a>00113       tabifyDockWidget(dock_widgets.at(i-1), widget);
<a name="l00114"></a>00114     }
<a name="l00115"></a>00115   }
<a name="l00116"></a>00116 
<a name="l00117"></a>00117   <span class="comment">// Set up the inter-panel communication channels</span>
<a name="l00118"></a>00118   connect(<a class="code" href="class_main_window.html#ab2b954f1b53302af498f9f83948f3fa5" title="Allows objects to be given printing materials.">materials_panel_</a>, SIGNAL(changedMaterials(QStringList)),
<a name="l00119"></a>00119           <a class="code" href="class_main_window.html#a7542af37381cff5cf5720f9e825938cd" title="Handles slicing/pathing/toolscript.">print_panel_</a>, SLOT(onChangedMaterials(QStringList)));
<a name="l00120"></a>00120   connect(<a class="code" href="class_main_window.html#a7542af37381cff5cf5720f9e825938cd" title="Handles slicing/pathing/toolscript.">print_panel_</a>, SIGNAL(<a class="code" href="class_main_window.html#a807a36499c006fb8924b7f5d4257ec81">glRepaint</a>()),
<a name="l00121"></a>00121           <span class="keyword">this</span>, SLOT(<a class="code" href="class_main_window.html#a807a36499c006fb8924b7f5d4257ec81">glRepaint</a>()), Qt::QueuedConnection);
<a name="l00122"></a>00122 
<a name="l00123"></a>00123   <span class="comment">// Disable panels when printing</span>
<a name="l00124"></a>00124   connect(<a class="code" href="class_main_window.html#a7542af37381cff5cf5720f9e825938cd" title="Handles slicing/pathing/toolscript.">print_panel_</a>, SIGNAL(printingStatus(<span class="keywordtype">bool</span>)),
<a name="l00125"></a>00125           <a class="code" href="class_main_window.html#adfab654511e443d02a0adc2d1910851c" title="Allows objects to be reoriented.">position_objects_panel_</a>, SLOT(setDisabled(<span class="keywordtype">bool</span>)));
<a name="l00126"></a>00126   connect(<a class="code" href="class_main_window.html#a7542af37381cff5cf5720f9e825938cd" title="Handles slicing/pathing/toolscript.">print_panel_</a>, SIGNAL(printingStatus(<span class="keywordtype">bool</span>)),
<a name="l00127"></a>00127           <a class="code" href="class_main_window.html#ae63126f188819c07771852e0a4b91f6b" title="Provides ways of bringing objects into the scene.">load_objects_panel_</a>, SLOT(setDisabled(<span class="keywordtype">bool</span>)));
<a name="l00128"></a>00128   connect(<a class="code" href="class_main_window.html#a7542af37381cff5cf5720f9e825938cd" title="Handles slicing/pathing/toolscript.">print_panel_</a>, SIGNAL(printingStatus(<span class="keywordtype">bool</span>)),
<a name="l00129"></a>00129           <a class="code" href="class_main_window.html#ab2b954f1b53302af498f9f83948f3fa5" title="Allows objects to be given printing materials.">materials_panel_</a>, SLOT(setDisabled(<span class="keywordtype">bool</span>)));
<a name="l00130"></a>00130   connect(<a class="code" href="class_main_window.html#a7542af37381cff5cf5720f9e825938cd" title="Handles slicing/pathing/toolscript.">print_panel_</a>, SIGNAL(printingStatus(<span class="keywordtype">bool</span>)),
<a name="l00131"></a>00131           <a class="code" href="class_main_window.html#ae33c89fc0b34d28d8a7c22e9f06d2f2d" title="Provides a breadcrumb of buttons.">toolbar_</a>, SLOT(setDisabled(<span class="keywordtype">bool</span>)));
<a name="l00132"></a>00132   connect(<a class="code" href="class_main_window.html#a7542af37381cff5cf5720f9e825938cd" title="Handles slicing/pathing/toolscript.">print_panel_</a>, SIGNAL(printingStatus(<span class="keywordtype">bool</span>)),
<a name="l00133"></a>00133           <a class="code" href="class_main_window.html#a35466a70ed47252a0191168126a352a5">ui</a>-&gt;<a class="code" href="class_ui___main_window.html#a9e7f2ce6c3d8a309109baed7d6890604">menuView</a>, SLOT(setDisabled(<span class="keywordtype">bool</span>)));
<a name="l00134"></a>00134 
<a name="l00135"></a>00135   <span class="comment">// Don&#39;t display these windows on startup</span>
<a name="l00136"></a>00136   <a class="code" href="class_main_window.html#a7542af37381cff5cf5720f9e825938cd" title="Handles slicing/pathing/toolscript.">print_panel_</a>-&gt;close();
<a name="l00137"></a>00137   <a class="code" href="class_main_window.html#ab2b954f1b53302af498f9f83948f3fa5" title="Allows objects to be given printing materials.">materials_panel_</a>-&gt;close();
<a name="l00138"></a>00138 
<a name="l00139"></a>00139   <span class="comment">// Initialize the graphics view</span>
<a name="l00140"></a>00140   <a class="code" href="class_main_window.html#af57701e45c39adf2a1a1f5ed16d79dba" title="This object controls the main OpenGL renderer and all visual 3d effects.">opengl_widget_</a> = <span class="keyword">new</span> <a class="code" href="class_open_g_l_widget.html">OpenGLWidget</a>(<span class="keyword">this</span>, <a class="code" href="class_main_window.html#a35466a70ed47252a0191168126a352a5">ui</a>-&gt;<a class="code" href="class_ui___main_window.html#a713d8e541d9de8389ad4292131dc931a">graphicsView</a>, <span class="stringliteral">&quot;OpenGLWidget&quot;</span>);
<a name="l00141"></a>00141   <a class="code" href="class_main_window.html#af57701e45c39adf2a1a1f5ed16d79dba" title="This object controls the main OpenGL renderer and all visual 3d effects.">opengl_widget_</a>-&gt;makeCurrent();
<a name="l00142"></a>00142   <a class="code" href="class_main_window.html#af57701e45c39adf2a1a1f5ed16d79dba" title="This object controls the main OpenGL renderer and all visual 3d effects.">opengl_widget_</a>-&gt;setSizePolicy(QSizePolicy::Expanding,QSizePolicy::Expanding);
<a name="l00143"></a>00143   <a class="code" href="class_main_window.html#af57701e45c39adf2a1a1f5ed16d79dba" title="This object controls the main OpenGL renderer and all visual 3d effects.">opengl_widget_</a>-&gt;acceptDrops();
<a name="l00144"></a>00144   connect(&amp;<a class="code" href="class_main_window.html#a9deff61d24d2fdfb2341043ae489ef70">gl_repaint_timer_</a>, SIGNAL(timeout()), <a class="code" href="class_main_window.html#af57701e45c39adf2a1a1f5ed16d79dba" title="This object controls the main OpenGL renderer and all visual 3d effects.">opengl_widget_</a>, SLOT(repaint()));
<a name="l00145"></a>00145 
<a name="l00146"></a>00146   <span class="comment">// Reset mouse information</span>
<a name="l00147"></a>00147   <a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.object = 0;
<a name="l00148"></a>00148   <a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.handle = <a class="code" href="printableobjecthandle_8h.html#a21d45d7694b78139ec0345ff8a617732a85f88cbb351315d9a44fa5ba1f3e7711">kNoHandles</a>;
<a name="l00149"></a>00149   <a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.axis = <a class="code" href="printableobjecthandle_8h.html#a5e33796668d54c255a99a1f64301fed6a6b7a2b2135ae2dc8e5c628cea727d1e0">kNoAxis</a>;
<a name="l00150"></a>00150   <a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.down = <span class="keyword">false</span>;
<a name="l00151"></a>00151 
<a name="l00152"></a>00152   <span class="comment">// Make sure everything is switched to basic mode</span>
<a name="l00153"></a>00153   QSettings settings;
<a name="l00154"></a>00154   <span class="keywordtype">bool</span> advanced_mode = settings.value(<a class="code" href="mainwindow_8cpp.html#acad3eb6382b41bd0fad76b7afa427b8d">kAdvancedModeSettingKey</a>, <span class="keyword">false</span>).toBool();
<a name="l00155"></a>00155   <a class="code" href="class_main_window.html#a35466a70ed47252a0191168126a352a5">ui</a>-&gt;<a class="code" href="class_ui___main_window.html#a81eed404242ab88d58968e12c4e46356">actionEnable_Advanced_Features</a>-&gt;setChecked(advanced_mode);
<a name="l00156"></a>00156   <a class="code" href="class_main_window.html#adfa362b12ec71954709543ca552f4279">useAdvancedMode</a>(advanced_mode);
<a name="l00157"></a>00157   <a class="code" href="class_main_window.html#a3159ee228ade18762d9cd2adc7650f9c">updateCheckMarks</a>();
<a name="l00158"></a>00158 
<a name="l00159"></a>00159   <a class="code" href="class_main_window.html#afd3147cf6f897cdaf4c48f1afbe7e2fb">setAlwaysShowStartupInformation</a>(settings.value(<a class="code" href="mainwindow_8cpp.html#a30721e11c6fda03a29293f88e2354778">kAlwaysShowStartupInformationSettingKey</a>, <span class="keyword">false</span>).toBool());
<a name="l00160"></a>00160 }
<a name="l00161"></a>00161 
<a name="l00162"></a>00162 
<a name="l00163"></a>00163 
<a name="l00164"></a><a class="code" href="class_main_window.html#ae98d00a93bc118200eeef9f9bba1dba7">00164</a> <a class="code" href="class_main_window.html#ae98d00a93bc118200eeef9f9bba1dba7">MainWindow::~MainWindow</a>() {
<a name="l00165"></a>00165   {
<a name="l00166"></a>00166     QMutexLocker mutex(&amp;<a class="code" href="class_main_window.html#a8248124ea53e3f8a59e9cdbd68f0c353">printable_objects_mutex_</a>);
<a name="l00167"></a>00167 
<a name="l00168"></a>00168     <span class="comment">// Erase all loaded objects</span>
<a name="l00169"></a>00169     <span class="keywordflow">foreach</span> (<a class="code" href="class_printable_object.html">PrintableObject</a>* <span class="keywordtype">object</span>, <a class="code" href="class_main_window.html#a2161c23e2b84b26d19c82faa2567d619" title="Each object in the scene.">printable_objects_</a>) {
<a name="l00170"></a>00170       <a class="code" href="class_printable_object.html#a6e5169f42527e86f71d49109b8c380e4">PrintableObject::destroy</a>(<span class="keywordtype">object</span>);
<a name="l00171"></a>00171     }
<a name="l00172"></a>00172     <a class="code" href="class_main_window.html#a2161c23e2b84b26d19c82faa2567d619" title="Each object in the scene.">printable_objects_</a>.clear();
<a name="l00173"></a>00173   }
<a name="l00174"></a>00174 
<a name="l00175"></a>00175   { <span class="comment">// Erase the main panels</span>
<a name="l00176"></a>00176     <span class="keyword">delete</span> <a class="code" href="class_main_window.html#adfab654511e443d02a0adc2d1910851c" title="Allows objects to be reoriented.">position_objects_panel_</a>;
<a name="l00177"></a>00177     <span class="keyword">delete</span> <a class="code" href="class_main_window.html#ae63126f188819c07771852e0a4b91f6b" title="Provides ways of bringing objects into the scene.">load_objects_panel_</a>;
<a name="l00178"></a>00178     <span class="keyword">delete</span> <a class="code" href="class_main_window.html#a7542af37381cff5cf5720f9e825938cd" title="Handles slicing/pathing/toolscript.">print_panel_</a>;
<a name="l00179"></a>00179     <span class="keyword">delete</span> <a class="code" href="class_main_window.html#ab2b954f1b53302af498f9f83948f3fa5" title="Allows objects to be given printing materials.">materials_panel_</a>;
<a name="l00180"></a>00180   }
<a name="l00181"></a>00181 
<a name="l00182"></a>00182   <span class="keyword">delete</span> <a class="code" href="class_main_window.html#a35466a70ed47252a0191168126a352a5">ui</a>;
<a name="l00183"></a>00183 }
<a name="l00184"></a>00184 
<a name="l00185"></a>00185 
<a name="l00186"></a><a class="code" href="class_main_window.html#aab54ad952155feda5c8c7c8a8f20fbee">00186</a> <span class="keywordtype">void</span> <a class="code" href="class_main_window.html#aab54ad952155feda5c8c7c8a8f20fbee">MainWindow::workspaceDragEnterEvent</a>(QDragEnterEvent* event) {
<a name="l00187"></a>00187 
<a name="l00188"></a>00188   <span class="keywordflow">if</span> (<a class="code" href="class_main_window.html#ae63126f188819c07771852e0a4b91f6b" title="Provides ways of bringing objects into the scene.">load_objects_panel_</a>-&gt;<a class="code" href="class_load_objects_panel.html#aab7ee17b3ea990999173daa6a7792951">isSourceOfEvent</a>(event)) {
<a name="l00189"></a>00189     <span class="keyword">event</span>-&gt;acceptProposedAction();
<a name="l00190"></a>00190   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="class_main_window.html#ab2b954f1b53302af498f9f83948f3fa5" title="Allows objects to be given printing materials.">materials_panel_</a>-&gt;<a class="code" href="class_materials_panel.html#ae56a484d161a70aa6224946ac9d42212">isSourceOfEvent</a>(event)) {
<a name="l00191"></a>00191     <span class="keyword">event</span>-&gt;acceptProposedAction();
<a name="l00192"></a>00192   }
<a name="l00193"></a>00193 }
<a name="l00194"></a>00194 
<a name="l00195"></a><a class="code" href="class_main_window.html#a781a26dac3197896740167d0f4995fee">00195</a> <span class="keywordtype">void</span> <a class="code" href="class_main_window.html#a781a26dac3197896740167d0f4995fee">MainWindow::workspaceDropEvent</a>(QDropEvent* event) {
<a name="l00196"></a>00196   QString parameter;
<a name="l00197"></a>00197   <span class="keywordflow">if</span> (<a class="code" href="class_main_window.html#ae63126f188819c07771852e0a4b91f6b" title="Provides ways of bringing objects into the scene.">load_objects_panel_</a>-&gt;<a class="code" href="class_load_objects_panel.html#aede3867fe9485aa89131fc6f6789fd8c">getDraggedObjectFile</a>(event, &amp;parameter)) {
<a name="l00198"></a>00198     <span class="comment">// The user dragged a file from the load objects panel into the main window,</span>
<a name="l00199"></a>00199     <span class="comment">// so they want to load it into the workspace.  This takes time, so spawn</span>
<a name="l00200"></a>00200     <span class="comment">// a thread to do it.</span>
<a name="l00201"></a>00201     <a class="code" href="class_main_window.html#ae63126f188819c07771852e0a4b91f6b" title="Provides ways of bringing objects into the scene.">load_objects_panel_</a>-&gt;setEnabled(<span class="keyword">false</span>); <span class="comment">// disable the panel so they can&#39;t drag another</span>
<a name="l00202"></a>00202     <a class="code" href="class_main_window.html#a35466a70ed47252a0191168126a352a5">ui</a>-&gt;<a class="code" href="class_ui___main_window.html#a50fa481337604bcc8bf68de18ab16ecd">statusBar</a>-&gt;showMessage(<span class="stringliteral">&quot;Currently loading &quot;</span> + parameter);
<a name="l00203"></a>00203     <a class="code" href="struct_math_1_1_vector3.html">FAHVector3</a> location = <a class="code" href="class_main_window.html#a133af6abf681dc53b7f106522c961029">screenCoordinatesToTrayLocation</a>(event-&gt;pos());
<a name="l00204"></a>00204     <a class="code" href="class_main_window.html#a981b1438f8c5de5a0c526737dff322a8" title="Current thread loading an object file.">load_object_file_thread_</a> = <span class="keyword">new</span> <a class="code" href="class_load_object_file_thread.html">LoadObjectFileThread</a>(location, <span class="keyword">this</span>, parameter);
<a name="l00205"></a>00205     connect(load_object_file_thread_, SIGNAL(finished()), <span class="keyword">this</span>, SLOT(<a class="code" href="class_main_window.html#a8dc402e36f106189418311baedffa9f9">finishedLoadObjectFile</a>()), Qt::QueuedConnection);
<a name="l00206"></a>00206     connect(load_object_file_thread_, SIGNAL(finished()), <a class="code" href="class_main_window.html#a35466a70ed47252a0191168126a352a5">ui</a>-&gt;<a class="code" href="class_ui___main_window.html#a50fa481337604bcc8bf68de18ab16ecd">statusBar</a>, SLOT(clearMessage()), Qt::QueuedConnection);
<a name="l00207"></a>00207     connect(load_object_file_thread_, SIGNAL(finished()), <span class="keyword">this</span>, SLOT(<a class="code" href="class_main_window.html#a3159ee228ade18762d9cd2adc7650f9c">updateCheckMarks</a>()), Qt::QueuedConnection);
<a name="l00208"></a>00208     connect(load_object_file_thread_, SIGNAL(finished()), <span class="keyword">this</span>, SLOT(<a class="code" href="class_main_window.html#a807a36499c006fb8924b7f5d4257ec81">glRepaint</a>()), Qt::QueuedConnection);
<a name="l00209"></a>00209     load_object_file_thread_-&gt;start();
<a name="l00210"></a>00210   }  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="class_main_window.html#ab2b954f1b53302af498f9f83948f3fa5" title="Allows objects to be given printing materials.">materials_panel_</a>-&gt;<a class="code" href="class_materials_panel.html#afe7a7752b7add5e8936691a34404a97e">getDraggedMaterialName</a>(event, &amp;parameter)) {
<a name="l00211"></a>00211     <span class="comment">// User is dropping a material on to an object.  Let&#39;s find out which object!</span>
<a name="l00212"></a>00212 
<a name="l00213"></a>00213     QPoint p = <a class="code" href="class_main_window.html#af57701e45c39adf2a1a1f5ed16d79dba" title="This object controls the main OpenGL renderer and all visual 3d effects.">opengl_widget_</a>-&gt;mapFromGlobal(QCursor::pos());
<a name="l00214"></a>00214     <a class="code" href="class_open_g_l_camera.html">OpenGLCamera</a>* camera = <a class="code" href="class_main_window.html#af57701e45c39adf2a1a1f5ed16d79dba" title="This object controls the main OpenGL renderer and all visual 3d effects.">opengl_widget_</a>-&gt;<a class="code" href="class_open_g_l_widget.html#a4e4975d452ab06dd21717de6ffe1b362">camera</a>();
<a name="l00215"></a>00215     <a class="code" href="struct_math_1_1_vector3.html">FAHVector3</a> gv = camera-&gt;<a class="code" href="class_open_g_l_camera.html#a8e4387490ef9e9af91c5e5d3c4e46e21">raycastFromScreen</a>(p.x(), p.y());
<a name="l00216"></a>00216     <a class="code" href="struct_math_1_1_vector3.html">FAHVector3</a> eye = camera-&gt;<a class="code" href="class_open_g_l_camera.html#a3e6ff57d1d2e5c559b4bddf660df15a3">getEye</a>();
<a name="l00217"></a>00217 
<a name="l00218"></a>00218     <a class="code" href="class_printable_object.html">PrintableObject</a>* found = 0;
<a name="l00219"></a>00219     <span class="keywordtype">float</span> found_radius = 0.0f;
<a name="l00220"></a>00220     <span class="keywordflow">foreach</span> (<a class="code" href="class_printable_object.html">PrintableObject</a>* <span class="keywordtype">object</span>, <a class="code" href="class_main_window.html#a2161c23e2b84b26d19c82faa2567d619" title="Each object in the scene.">printable_objects_</a>) {
<a name="l00221"></a>00221       <span class="keywordflow">if</span> (object-&gt;<a class="code" href="class_printable_object.html#a9b9006d5b0eb4c7e221416a4b66b163f">boundingSphere</a>().<a class="code" href="struct_math_1_1_sphere.html#a446371635668ee52f5ec0b3eed284b31">intersects</a>(eye, gv) &amp;&amp; (!found || found_radius &gt; <span class="keywordtype">object</span>-&gt;<a class="code" href="class_printable_object.html#a9b9006d5b0eb4c7e221416a4b66b163f">boundingSphere</a>().<a class="code" href="struct_math_1_1_sphere.html#a80bcacf256a1a429df0578650db6b195">radius</a>)) {
<a name="l00222"></a>00222         found_radius = <span class="keywordtype">object</span>-&gt;boundingSphere().radius;
<a name="l00223"></a>00223         found = object;
<a name="l00224"></a>00224       }
<a name="l00225"></a>00225     }
<a name="l00226"></a>00226 
<a name="l00227"></a>00227     <span class="keywordflow">if</span> (found) {
<a name="l00228"></a>00228       <span class="comment">// assign this material to the object</span>
<a name="l00229"></a>00229       QSet&lt;int&gt; fill_material_ids = found-&gt;<a class="code" href="class_printable_object.html#a892d796227c62ea31fcc0f7cb6c7e817">fillMaterialIDs</a>();
<a name="l00230"></a>00230       <span class="keywordtype">bool</span> material_chosen = <span class="keyword">true</span>;
<a name="l00231"></a>00231       <span class="keywordtype">int</span> fill_material_id = 0;
<a name="l00232"></a>00232       <span class="keywordflow">if</span> (fill_material_ids.size() == 1) {
<a name="l00233"></a>00233         fill_material_id = fill_material_ids.values().first();
<a name="l00234"></a>00234       } <span class="keywordflow">else</span> {
<a name="l00235"></a>00235 
<a name="l00236"></a>00236         <a class="code" href="todo_8h.html#ae61a00cdcabcd21f703f7ad228eb25db">todo</a>(<span class="stringliteral">&quot;kwg8&quot;</span>,<span class="stringliteral">&quot;this has not actually been tested&quot;</span>);
<a name="l00237"></a>00237 
<a name="l00238"></a>00238         <span class="comment">// pop a right-click menu</span>
<a name="l00239"></a>00239         QMenu menu(<span class="keyword">this</span>);
<a name="l00240"></a>00240         QMap&lt;QAction*, int&gt; action_to_material;
<a name="l00241"></a>00241         <span class="keywordflow">foreach</span> (<span class="keywordtype">int</span> material_id, fill_material_ids) {
<a name="l00242"></a>00242           QString str;
<a name="l00243"></a>00243           str.sprintf(<span class="stringliteral">&quot;Material ID %d&quot;</span>, material_id);
<a name="l00244"></a>00244           action_to_material.insert(menu.addAction(str), material_id);
<a name="l00245"></a>00245         }
<a name="l00246"></a>00246         QAction* action = menu.exec(QCursor::pos());
<a name="l00247"></a>00247         <span class="keywordflow">if</span> (action) {
<a name="l00248"></a>00248           fill_material_id = action_to_material.find(action).value();
<a name="l00249"></a>00249         } <span class="keywordflow">else</span> {
<a name="l00250"></a>00250           material_chosen = <span class="keyword">false</span>;
<a name="l00251"></a>00251         }
<a name="l00252"></a>00252       }
<a name="l00253"></a>00253       <span class="keywordflow">if</span> (material_chosen) {
<a name="l00254"></a>00254         found-&gt;<a class="code" href="class_printable_object.html#ace66c00257450919a35971a70e22fe26">setFillMaterial</a>(fill_material_id, parameter);
<a name="l00255"></a>00255 
<a name="l00256"></a>00256         <a class="code" href="class_main_window.html#a757eba9bb43a9041bbb6c3a8b46c4139">updateMaterialColorAssignments</a>();
<a name="l00257"></a>00257 
<a name="l00258"></a>00258         <a class="code" href="class_main_window.html#a3159ee228ade18762d9cd2adc7650f9c">updateCheckMarks</a>();
<a name="l00259"></a>00259       }
<a name="l00260"></a>00260     }
<a name="l00261"></a>00261   }
<a name="l00262"></a>00262 }
<a name="l00263"></a>00263 
<a name="l00264"></a>00264 
<a name="l00265"></a><a class="code" href="class_main_window.html#a6e357fae38fe959d4443e4fb849791c9">00265</a> <span class="keywordtype">void</span> <a class="code" href="class_main_window.html#a6e357fae38fe959d4443e4fb849791c9">MainWindow::showLoadObjectsPanel</a>() {
<a name="l00266"></a>00266   <a class="code" href="class_main_window.html#ae63126f188819c07771852e0a4b91f6b" title="Provides ways of bringing objects into the scene.">load_objects_panel_</a>-&gt;show();
<a name="l00267"></a>00267   <a class="code" href="class_main_window.html#ae63126f188819c07771852e0a4b91f6b" title="Provides ways of bringing objects into the scene.">load_objects_panel_</a>-&gt;raise();
<a name="l00268"></a>00268 }
<a name="l00269"></a>00269 
<a name="l00270"></a>00270 
<a name="l00271"></a><a class="code" href="class_main_window.html#a810e289a105c9df65cf8711320395e00">00271</a> <span class="keywordtype">void</span> <a class="code" href="class_main_window.html#a810e289a105c9df65cf8711320395e00">MainWindow::showPrintPanel</a>() {
<a name="l00272"></a>00272   <a class="code" href="class_main_window.html#a7542af37381cff5cf5720f9e825938cd" title="Handles slicing/pathing/toolscript.">print_panel_</a>-&gt;show();
<a name="l00273"></a>00273   <a class="code" href="class_main_window.html#a7542af37381cff5cf5720f9e825938cd" title="Handles slicing/pathing/toolscript.">print_panel_</a>-&gt;raise();
<a name="l00274"></a>00274 }
<a name="l00275"></a>00275 
<a name="l00276"></a>00276 
<a name="l00277"></a><a class="code" href="class_main_window.html#a54ba01ddbe3978bf08e7cd70704682cf">00277</a> <span class="keywordtype">void</span> <a class="code" href="class_main_window.html#a54ba01ddbe3978bf08e7cd70704682cf">MainWindow::showMaterialsPanel</a>() {
<a name="l00278"></a>00278   <a class="code" href="class_main_window.html#ab2b954f1b53302af498f9f83948f3fa5" title="Allows objects to be given printing materials.">materials_panel_</a>-&gt;show();
<a name="l00279"></a>00279   <a class="code" href="class_main_window.html#ab2b954f1b53302af498f9f83948f3fa5" title="Allows objects to be given printing materials.">materials_panel_</a>-&gt;raise();
<a name="l00280"></a>00280 }
<a name="l00281"></a>00281 
<a name="l00282"></a><a class="code" href="class_main_window.html#aefec13b58e434cc122bc6f4147af1a8e">00282</a> <span class="keywordtype">void</span> <a class="code" href="class_main_window.html#aefec13b58e434cc122bc6f4147af1a8e">MainWindow::showPositionObjectsPanel</a>() {
<a name="l00283"></a>00283   <a class="code" href="class_main_window.html#adfab654511e443d02a0adc2d1910851c" title="Allows objects to be reoriented.">position_objects_panel_</a>-&gt;show();
<a name="l00284"></a>00284   <a class="code" href="class_main_window.html#adfab654511e443d02a0adc2d1910851c" title="Allows objects to be reoriented.">position_objects_panel_</a>-&gt;raise();
<a name="l00285"></a>00285 }
<a name="l00286"></a>00286 
<a name="l00287"></a>00287 
<a name="l00288"></a><a class="code" href="class_main_window.html#a133af6abf681dc53b7f106522c961029">00288</a> <a class="code" href="struct_math_1_1_vector3.html">FAHVector3</a> <a class="code" href="class_main_window.html#a133af6abf681dc53b7f106522c961029">MainWindow::screenCoordinatesToTrayLocation</a>(<span class="keyword">const</span> QPoint&amp; point) {
<a name="l00289"></a>00289   <a class="code" href="class_open_g_l_camera.html">OpenGLCamera</a>* camera = <a class="code" href="class_main_window.html#af57701e45c39adf2a1a1f5ed16d79dba" title="This object controls the main OpenGL renderer and all visual 3d effects.">opengl_widget_</a>-&gt;<a class="code" href="class_open_g_l_widget.html#a4e4975d452ab06dd21717de6ffe1b362">camera</a>();
<a name="l00290"></a>00290   <a class="code" href="struct_math_1_1_vector3.html">OpenGLCamera::GLVector3</a> gv = camera-&gt;<a class="code" href="class_open_g_l_camera.html#a8e4387490ef9e9af91c5e5d3c4e46e21">raycastFromScreen</a>(point.x(), point.y());
<a name="l00291"></a>00291   <a class="code" href="struct_math_1_1_vector3.html">OpenGLCamera::GLVector3</a> eye = camera-&gt;<a class="code" href="class_open_g_l_camera.html#a3e6ff57d1d2e5c559b4bddf660df15a3">getEye</a>();
<a name="l00292"></a>00292   gv.<a class="code" href="struct_math_1_1_vector3.html#a2af105ca2bee1482f7b325bf163b41f1">scale</a>(-eye.<a class="code" href="struct_math_1_1_vector3.html#a3fa4134a62a3153cf30b60d8ac719c05">z</a>/gv.<a class="code" href="struct_math_1_1_vector3.html#a3fa4134a62a3153cf30b60d8ac719c05">z</a>).add(eye); <span class="comment">// intersect with z=0 plane</span>
<a name="l00293"></a>00293   <a class="code" href="struct_math_1_1_vector3.html">FAHVector3</a> fv(gv.<a class="code" href="struct_math_1_1_vector3.html#aae835fbe51212f299df619a902f9296c">x</a>, gv.<a class="code" href="struct_math_1_1_vector3.html#a09e80ead9117655b11803566070f70f6">y</a>, gv.<a class="code" href="struct_math_1_1_vector3.html#a3fa4134a62a3153cf30b60d8ac719c05">z</a>);
<a name="l00294"></a>00294   <span class="keywordflow">return</span> fv;
<a name="l00295"></a>00295 }
<a name="l00296"></a>00296 
<a name="l00297"></a>00297 
<a name="l00298"></a><a class="code" href="class_main_window.html#ae30f5d36005cc611f865364abeab0607">00298</a> <span class="keywordtype">void</span> <a class="code" href="class_main_window.html#ae30f5d36005cc611f865364abeab0607">MainWindow::addObject</a>(<span class="keyword">const</span> QString&amp; source_file, <a class="code" href="class_printable_object.html">PrintableObject</a>* <span class="keywordtype">object</span>) {
<a name="l00299"></a>00299 
<a name="l00300"></a>00300   <span class="comment">// Automatically reorient the object if the user is running in &quot;basic&quot; mode</span>
<a name="l00301"></a>00301   <span class="keywordflow">if</span> (!<a class="code" href="class_main_window.html#a35466a70ed47252a0191168126a352a5">ui</a>-&gt;<a class="code" href="class_ui___main_window.html#a81eed404242ab88d58968e12c4e46356">actionEnable_Advanced_Features</a>-&gt;isChecked()) {
<a name="l00302"></a>00302     <span class="keywordtype">object</span>-&gt;setBestOrientation();
<a name="l00303"></a>00303   }
<a name="l00304"></a>00304 
<a name="l00305"></a>00305   <span class="comment">// Add the object to the scene</span>
<a name="l00306"></a>00306   QMutexLocker mutex(&amp;<a class="code" href="class_main_window.html#a8248124ea53e3f8a59e9cdbd68f0c353">printable_objects_mutex_</a>);
<a name="l00307"></a>00307   <a class="code" href="class_main_window.html#a2161c23e2b84b26d19c82faa2567d619" title="Each object in the scene.">printable_objects_</a>.append(<span class="keywordtype">object</span>);
<a name="l00308"></a>00308   <span class="keywordtype">object</span>-&gt;snapToRestOnXYPlane();
<a name="l00309"></a>00309 }
<a name="l00310"></a>00310 
<a name="l00311"></a>00311 
<a name="l00312"></a><a class="code" href="class_main_window.html#ab0410e7320602e41f07195fab2b0f528">00312</a> <span class="keywordtype">void</span> <a class="code" href="class_main_window.html#ab0410e7320602e41f07195fab2b0f528">MainWindow::removeObject</a>(<a class="code" href="class_printable_object.html">PrintableObject</a>* <span class="keywordtype">object</span>) {
<a name="l00313"></a>00313   <a class="code" href="confirm_8h.html#a849ce00d16854946d87935e0a66b0466">confirm</a>(<span class="keywordtype">object</span>) <span class="keywordflow">else</span> <span class="keywordflow">return</span>;
<a name="l00314"></a>00314   <a class="code" href="confirm_8h.html#a849ce00d16854946d87935e0a66b0466">confirm</a>(<a class="code" href="class_main_window.html#a2161c23e2b84b26d19c82faa2567d619" title="Each object in the scene.">printable_objects_</a>.removeOne(<span class="keywordtype">object</span>));
<a name="l00315"></a>00315   <span class="keywordflow">if</span> (<a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.object == <span class="keywordtype">object</span>) {
<a name="l00316"></a>00316     <a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.object = 0;
<a name="l00317"></a>00317   }
<a name="l00318"></a>00318   <span class="keywordflow">if</span> (<a class="code" href="class_main_window.html#a2f996598d11f383730e14625b3d34edd" title="Object currently selected for editing (it has the handles!).">selected_object_</a> == <span class="keywordtype">object</span>) {
<a name="l00319"></a>00319     <a class="code" href="class_main_window.html#a4b3bf8d42d0fabf05e956403c59e2b2c">selectObject</a>(0);
<a name="l00320"></a>00320     <a class="code" href="confirm_8h.html#a849ce00d16854946d87935e0a66b0466">confirm</a>(<a class="code" href="class_main_window.html#a2f996598d11f383730e14625b3d34edd" title="Object currently selected for editing (it has the handles!).">selected_object_</a> == 0);
<a name="l00321"></a>00321   }
<a name="l00322"></a>00322   <a class="code" href="class_printable_object.html#a6e5169f42527e86f71d49109b8c380e4">PrintableObject::destroy</a>(<span class="keywordtype">object</span>);
<a name="l00323"></a>00323   <a class="code" href="class_main_window.html#a757eba9bb43a9041bbb6c3a8b46c4139">updateMaterialColorAssignments</a>(); <span class="comment">// calls glRepaint()</span>
<a name="l00324"></a>00324   <a class="code" href="class_main_window.html#a3159ee228ade18762d9cd2adc7650f9c">updateCheckMarks</a>();
<a name="l00325"></a>00325 }
<a name="l00326"></a>00326 
<a name="l00327"></a>00327 
<a name="l00328"></a><a class="code" href="class_main_window.html#a1a82989089363ca43fc048f39fe2402f">00328</a> <span class="keywordtype">void</span> <a class="code" href="class_main_window.html#a1a82989089363ca43fc048f39fe2402f">MainWindow::clearSelectedObjectFillMaterials</a>() {
<a name="l00329"></a>00329   <span class="keywordflow">if</span> (!<a class="code" href="class_main_window.html#a2f996598d11f383730e14625b3d34edd" title="Object currently selected for editing (it has the handles!).">selected_object_</a>) <span class="keywordflow">return</span>;
<a name="l00330"></a>00330   <a class="code" href="class_main_window.html#a2f996598d11f383730e14625b3d34edd" title="Object currently selected for editing (it has the handles!).">selected_object_</a>-&gt;<a class="code" href="class_printable_object.html#a6c41d1d950b4e21427b02601954f883a">clearFillMaterials</a>();
<a name="l00331"></a>00331   <a class="code" href="class_main_window.html#a757eba9bb43a9041bbb6c3a8b46c4139">updateMaterialColorAssignments</a>();
<a name="l00332"></a>00332   <a class="code" href="class_main_window.html#a3159ee228ade18762d9cd2adc7650f9c">updateCheckMarks</a>();
<a name="l00333"></a>00333 }
<a name="l00334"></a>00334 
<a name="l00335"></a><a class="code" href="class_main_window.html#a06c89af45792edef28b4d0971024e3eb">00335</a> <span class="keywordtype">void</span> <a class="code" href="class_main_window.html#a06c89af45792edef28b4d0971024e3eb">MainWindow::clearAllObjectFillMaterials</a>() {
<a name="l00336"></a>00336   <span class="keywordflow">foreach</span> (<a class="code" href="class_printable_object.html">PrintableObject</a>* <span class="keywordtype">object</span>, <a class="code" href="class_main_window.html#a2161c23e2b84b26d19c82faa2567d619" title="Each object in the scene.">printable_objects_</a>)  {
<a name="l00337"></a>00337     <span class="keywordtype">object</span>-&gt;clearFillMaterials();
<a name="l00338"></a>00338   }
<a name="l00339"></a>00339   <a class="code" href="class_main_window.html#a757eba9bb43a9041bbb6c3a8b46c4139">updateMaterialColorAssignments</a>();
<a name="l00340"></a>00340   <a class="code" href="class_main_window.html#a3159ee228ade18762d9cd2adc7650f9c">updateCheckMarks</a>();
<a name="l00341"></a>00341 }
<a name="l00342"></a>00342 
<a name="l00343"></a>00343 
<a name="l00344"></a><a class="code" href="class_main_window.html#ab2df1f370bfb84e51b852a32b8bdcaa0">00344</a> <span class="keywordtype">void</span> <a class="code" href="class_main_window.html#ab2df1f370bfb84e51b852a32b8bdcaa0">MainWindow::glRender</a>() {
<a name="l00345"></a>00345   <span class="keywordflow">if</span> (!<a class="code" href="class_main_window.html#af57701e45c39adf2a1a1f5ed16d79dba" title="This object controls the main OpenGL renderer and all visual 3d effects.">opengl_widget_</a>) <span class="keywordflow">return</span>;
<a name="l00346"></a>00346 
<a name="l00347"></a>00347   <span class="comment">// Build area size in millimeters</span>
<a name="l00348"></a>00348   <span class="keywordtype">float</span> print_area_width_ = 35.0f * 10.0f;
<a name="l00349"></a>00349   <span class="keywordtype">float</span> print_area_height_ = 28.0f * 10.0f;
<a name="l00350"></a>00350   <a class="code" href="namespace_open_g_l_primitives.html#a9c5c43cd25a69f61dba9f647c7b42093">OpenGLPrimitives::renderGrid</a>(print_area_width_, print_area_height_, 10.0f);
<a name="l00351"></a>00351 
<a name="l00352"></a>00352   QMutexLocker mutex(&amp;<a class="code" href="class_main_window.html#a8248124ea53e3f8a59e9cdbd68f0c353">printable_objects_mutex_</a>);
<a name="l00353"></a>00353 
<a name="l00354"></a>00354   QPoint p = <a class="code" href="class_main_window.html#af57701e45c39adf2a1a1f5ed16d79dba" title="This object controls the main OpenGL renderer and all visual 3d effects.">opengl_widget_</a>-&gt;mapFromGlobal(QCursor::pos());
<a name="l00355"></a>00355 
<a name="l00356"></a>00356   <a class="code" href="class_open_g_l_camera.html">OpenGLCamera</a>* camera = <a class="code" href="class_main_window.html#af57701e45c39adf2a1a1f5ed16d79dba" title="This object controls the main OpenGL renderer and all visual 3d effects.">opengl_widget_</a>-&gt;<a class="code" href="class_open_g_l_widget.html#a4e4975d452ab06dd21717de6ffe1b362">camera</a>();
<a name="l00357"></a>00357   <a class="code" href="struct_math_1_1_vector3.html">FAHVector3</a> gv = camera-&gt;<a class="code" href="class_open_g_l_camera.html#a8e4387490ef9e9af91c5e5d3c4e46e21">raycastFromScreen</a>(p.x(), p.y());
<a name="l00358"></a>00358   <a class="code" href="struct_math_1_1_vector3.html">FAHVector3</a> eye = camera-&gt;<a class="code" href="class_open_g_l_camera.html#a3e6ff57d1d2e5c559b4bddf660df15a3">getEye</a>();
<a name="l00359"></a>00359 
<a name="l00360"></a>00360   glPolygonMode( GL_FRONT_AND_BACK, GL_FILL );
<a name="l00361"></a>00361 
<a name="l00362"></a>00362   <span class="comment">// Draw the print-panel&#39;s preview BEFORE objects so that, if they are</span>
<a name="l00363"></a>00363   <span class="comment">// rendered semi-transparently, the stuff inside can be seen</span>
<a name="l00364"></a>00364   <a class="code" href="class_main_window.html#a7542af37381cff5cf5720f9e825938cd" title="Handles slicing/pathing/toolscript.">print_panel_</a>-&gt;<a class="code" href="class_print_panel.html#a38b685aebf9eeed51daa226b1eace4f1">glRender</a>();
<a name="l00365"></a>00365 
<a name="l00366"></a>00366   <span class="comment">// Draw each object in the scene</span>
<a name="l00367"></a>00367   <span class="keywordflow">foreach</span> (<a class="code" href="class_printable_object.html">PrintableObject</a>* <span class="keywordtype">object</span>, <a class="code" href="class_main_window.html#a2161c23e2b84b26d19c82faa2567d619" title="Each object in the scene.">printable_objects_</a>) {
<a name="l00368"></a>00368     <span class="comment">// Draw the object.  If a print is in progress, this object is</span>
<a name="l00369"></a>00369     <span class="comment">// rendered semi-transparently.</span>
<a name="l00370"></a>00370     <span class="keywordtype">bool</span> transparent = <a class="code" href="class_main_window.html#a7542af37381cff5cf5720f9e825938cd" title="Handles slicing/pathing/toolscript.">print_panel_</a>-&gt;<a class="code" href="class_print_panel.html#a028cf0c62ba0316b3ba594994e73c10d">isPrintInProgress</a>() ||
<a name="l00371"></a>00371                        (<span class="keywordtype">object</span> == <a class="code" href="class_main_window.html#a2f996598d11f383730e14625b3d34edd" title="Object currently selected for editing (it has the handles!).">selected_object_</a> &amp;&amp; <a class="code" href="class_main_window.html#a2b321541b8ebe773323500833d9e3b73">isOffOfBuildTray</a>(<span class="keywordtype">object</span>));
<a name="l00372"></a>00372     <span class="keywordtype">object</span>-&gt;glRender(transparent);
<a name="l00373"></a>00373   }
<a name="l00374"></a>00374 
<a name="l00375"></a>00375   <span class="comment">// Render the mouse-over effect for this object</span>
<a name="l00376"></a>00376   <span class="keywordflow">if</span> (<a class="code" href="class_main_window.html#a4dc7f626c6584e20ae5ce588c79775aa">handleManipulationEnabled</a>() &amp;&amp; (<a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.object != 0)) {
<a name="l00377"></a>00377     glEnable(GL_BLEND);
<a name="l00378"></a>00378     glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
<a name="l00379"></a>00379 
<a name="l00380"></a>00380     glMatrixMode(GL_MODELVIEW);
<a name="l00381"></a>00381     glPushMatrix();
<a name="l00382"></a>00382     glLoadIdentity();
<a name="l00383"></a>00383     <a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.object-&gt;glRenderHandles(<a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.handle,
<a name="l00384"></a>00384                                    <a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.axis,
<a name="l00385"></a>00385                                    <a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.down,
<a name="l00386"></a>00386                                    <a class="code" href="class_main_window.html#a38a9f46d4a79cc78237ed0a4260dbded" title="Whether program is running in basic or advanced mode.">use_advanced_mode_</a> <span class="comment">// only render Z axis in advanced mode</span>
<a name="l00387"></a>00387                                    );
<a name="l00388"></a>00388     glPopMatrix();
<a name="l00389"></a>00389 
<a name="l00390"></a>00390     glDisable(GL_BLEND);
<a name="l00391"></a>00391   }
<a name="l00392"></a>00392 
<a name="l00393"></a>00393   <span class="comment">// Render the mouse-over effect for this object</span>
<a name="l00394"></a>00394   <span class="keywordflow">if</span> (<a class="code" href="class_main_window.html#a4dc7f626c6584e20ae5ce588c79775aa">handleManipulationEnabled</a>() &amp;&amp; <a class="code" href="class_main_window.html#a2f996598d11f383730e14625b3d34edd" title="Object currently selected for editing (it has the handles!).">selected_object_</a> != 0) {
<a name="l00395"></a>00395     glEnable(GL_BLEND);
<a name="l00396"></a>00396     glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
<a name="l00397"></a>00397 
<a name="l00398"></a>00398     glMatrixMode(GL_MODELVIEW);
<a name="l00399"></a>00399     glPushMatrix();
<a name="l00400"></a>00400     glLoadIdentity();
<a name="l00401"></a>00401     <a class="code" href="class_main_window.html#a2f996598d11f383730e14625b3d34edd" title="Object currently selected for editing (it has the handles!).">selected_object_</a>-&gt;<a class="code" href="class_printable_object.html#aa2e316a0e35a5dd7fa6c41d8cc06b883">glRenderHandles</a>(<a class="code" href="printableobjecthandle_8h.html#a21d45d7694b78139ec0345ff8a617732a85f88cbb351315d9a44fa5ba1f3e7711">kNoHandles</a>,
<a name="l00402"></a>00402                                       <a class="code" href="printableobjecthandle_8h.html#a5e33796668d54c255a99a1f64301fed6a6b7a2b2135ae2dc8e5c628cea727d1e0">kNoAxis</a>,
<a name="l00403"></a>00403                                       <span class="keyword">false</span>,
<a name="l00404"></a>00404                                       <a class="code" href="class_main_window.html#a38a9f46d4a79cc78237ed0a4260dbded" title="Whether program is running in basic or advanced mode.">use_advanced_mode_</a>);
<a name="l00405"></a>00405     glPopMatrix();
<a name="l00406"></a>00406 
<a name="l00407"></a>00407     glDisable(GL_BLEND);
<a name="l00408"></a>00408   }
<a name="l00409"></a>00409 }
<a name="l00410"></a>00410 
<a name="l00411"></a>00411 
<a name="l00412"></a><a class="code" href="class_main_window.html#a05768d2508911dba9bf7116379295320">00412</a> <a class="code" href="class_tool_script.html">ToolScript</a>* <a class="code" href="class_main_window.html#a05768d2508911dba9bf7116379295320">MainWindow::getToolScriptByName</a>(<span class="keyword">const</span> QString&amp; name) {
<a name="l00413"></a>00413   <span class="keywordflow">return</span> <a class="code" href="class_main_window.html#ab2b954f1b53302af498f9f83948f3fa5" title="Allows objects to be given printing materials.">materials_panel_</a>-&gt;<a class="code" href="class_materials_panel.html#a4639d19b2cf8eeb95a474145fe4a1f14">getToolScriptByName</a>(name);
<a name="l00414"></a>00414 }
<a name="l00415"></a>00415 
<a name="l00416"></a>00416 
<a name="l00417"></a>00417 
<a name="l00418"></a>00418 
<a name="l00419"></a><a class="code" href="class_main_window.html#ae12f8f63791595567b6250f8bb002bda">00419</a> <span class="keywordtype">void</span> <a class="code" href="class_main_window.html#ae12f8f63791595567b6250f8bb002bda">MainWindow::resizeEvent</a>(QResizeEvent* event) {
<a name="l00420"></a>00420   <a class="code" href="class_main_window.html#a86dee639709c4c8a14416b7fff63f8d0">graphicsViewUpdateSize</a>();
<a name="l00421"></a>00421   <a class="code" href="class_main_window.html#ae12f8f63791595567b6250f8bb002bda">QWidget::resizeEvent</a>(event);
<a name="l00422"></a>00422 }
<a name="l00423"></a>00423 
<a name="l00424"></a>00424 
<a name="l00425"></a><a class="code" href="class_main_window.html#a2cf42454562815dd44c716e78d515697">00425</a> <span class="keywordtype">void</span> <a class="code" href="class_main_window.html#a2cf42454562815dd44c716e78d515697">MainWindow::mouseMoveEvent</a>(QMouseEvent* event) {
<a name="l00426"></a>00426   QPoint p = <a class="code" href="class_main_window.html#af57701e45c39adf2a1a1f5ed16d79dba" title="This object controls the main OpenGL renderer and all visual 3d effects.">opengl_widget_</a>-&gt;mapFromGlobal(QCursor::pos());
<a name="l00427"></a>00427 
<a name="l00428"></a>00428   <span class="comment">// Get camera parameters</span>
<a name="l00429"></a>00429   <a class="code" href="class_open_g_l_camera.html">OpenGLCamera</a>* camera = <a class="code" href="class_main_window.html#af57701e45c39adf2a1a1f5ed16d79dba" title="This object controls the main OpenGL renderer and all visual 3d effects.">opengl_widget_</a>-&gt;<a class="code" href="class_open_g_l_widget.html#a4e4975d452ab06dd21717de6ffe1b362">camera</a>();
<a name="l00430"></a>00430   <a class="code" href="struct_math_1_1_vector3.html">FAHVector3</a> gv = camera-&gt;<a class="code" href="class_open_g_l_camera.html#a8e4387490ef9e9af91c5e5d3c4e46e21">raycastFromScreen</a>(p.x(), p.y());
<a name="l00431"></a>00431   <a class="code" href="struct_math_1_1_vector3.html">FAHVector3</a> eye = camera-&gt;<a class="code" href="class_open_g_l_camera.html#a3e6ff57d1d2e5c559b4bddf660df15a3">getEye</a>();
<a name="l00432"></a>00432 
<a name="l00433"></a>00433   <span class="keywordflow">if</span> (<a class="code" href="class_main_window.html#a4dc7f626c6584e20ae5ce588c79775aa">handleManipulationEnabled</a>()) {
<a name="l00434"></a>00434 
<a name="l00435"></a>00435     <span class="keywordflow">if</span> (<a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.down) {
<a name="l00436"></a>00436 
<a name="l00437"></a>00437       <span class="keywordflow">if</span> (<a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.handle != <a class="code" href="printableobjecthandle_8h.html#a21d45d7694b78139ec0345ff8a617732a85f88cbb351315d9a44fa5ba1f3e7711">kNoHandles</a> &amp;&amp;
<a name="l00438"></a>00438           <a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.axis != <a class="code" href="printableobjecthandle_8h.html#a5e33796668d54c255a99a1f64301fed6a6b7a2b2135ae2dc8e5c628cea727d1e0">kNoAxis</a>) {
<a name="l00439"></a>00439 
<a name="l00440"></a>00440         <span class="comment">// The mouse is being dragged and is adjusting some handle for the object</span>
<a name="l00441"></a>00441         <a class="code" href="confirm_8h.html#a849ce00d16854946d87935e0a66b0466">confirm</a>(<a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.object) <span class="keywordflow">else</span> {
<a name="l00442"></a>00442           <a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.handle = <a class="code" href="printableobjecthandle_8h.html#a21d45d7694b78139ec0345ff8a617732a85f88cbb351315d9a44fa5ba1f3e7711">kNoHandles</a>;
<a name="l00443"></a>00443           <a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.axis = <a class="code" href="printableobjecthandle_8h.html#a5e33796668d54c255a99a1f64301fed6a6b7a2b2135ae2dc8e5c628cea727d1e0">kNoAxis</a>;
<a name="l00444"></a>00444           <span class="keywordflow">return</span>;
<a name="l00445"></a>00445         }
<a name="l00446"></a>00446 
<a name="l00447"></a>00447         <span class="comment">// Pass the mouse&#39;s current coordinate to the object so it can be manipulated</span>
<a name="l00448"></a>00448         <a class="code" href="class_main_window.html#a4b3bf8d42d0fabf05e956403c59e2b2c">selectObject</a>(<a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.object);
<a name="l00449"></a>00449         <a class="code" href="class_main_window.html#a2f996598d11f383730e14625b3d34edd" title="Object currently selected for editing (it has the handles!).">selected_object_</a>-&gt;<a class="code" href="class_printable_object.html#a4ef2c2903f6b1a354f8e5cf8d014ecdb">handleManipulate</a>(<a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.handle,
<a name="l00450"></a>00450                                            <a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.axis,
<a name="l00451"></a>00451                                            eye,
<a name="l00452"></a>00452                                            <a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.down_ray,
<a name="l00453"></a>00453                                            gv);
<a name="l00454"></a>00454 
<a name="l00455"></a>00455         <span class="comment">// Update the position objects panel</span>
<a name="l00456"></a>00456         <span class="keywordflow">if</span> (!<a class="code" href="class_main_window.html#adfab654511e443d02a0adc2d1910851c" title="Allows objects to be reoriented.">position_objects_panel_</a>-&gt;isTopLevel()) <a class="code" href="class_main_window.html#aefec13b58e434cc122bc6f4147af1a8e">showPositionObjectsPanel</a>();
<a name="l00457"></a>00457         <a class="code" href="class_main_window.html#adfab654511e443d02a0adc2d1910851c" title="Allows objects to be reoriented.">position_objects_panel_</a>-&gt;<a class="code" href="class_position_objects_panel.html#adb3c01eb1bef1a0dd04603073b615f06">manipulatedObject</a>(<a class="code" href="class_main_window.html#a2f996598d11f383730e14625b3d34edd" title="Object currently selected for editing (it has the handles!).">selected_object_</a>);
<a name="l00458"></a>00458         <a class="code" href="class_main_window.html#adfab654511e443d02a0adc2d1910851c" title="Allows objects to be reoriented.">position_objects_panel_</a>-&gt;<a class="code" href="class_position_objects_panel.html#a73f2d8a00e3b9ad77917df99a6160e23">showDeletingObjectLabel</a>(<a class="code" href="class_main_window.html#a2b321541b8ebe773323500833d9e3b73">isOffOfBuildTray</a>(<a class="code" href="class_main_window.html#a2f996598d11f383730e14625b3d34edd" title="Object currently selected for editing (it has the handles!).">selected_object_</a>));
<a name="l00459"></a>00459 
<a name="l00460"></a>00460         <span class="keywordflow">switch</span> (<a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.handle) {
<a name="l00461"></a>00461         <span class="keywordflow">default</span>:
<a name="l00462"></a>00462           <a class="code" href="confirm_8h.html#a849ce00d16854946d87935e0a66b0466">confirm</a> (<span class="keyword">false</span> &amp;&amp; <span class="stringliteral">&quot;Handle should always be valid&quot;</span>);
<a name="l00463"></a>00463         <span class="keywordflow">case</span> <a class="code" href="printableobjecthandle_8h.html#a21d45d7694b78139ec0345ff8a617732ad45205c093b02e925000e6d3faa22014">kScalingHandles</a>:     <a class="code" href="class_main_window.html#adfab654511e443d02a0adc2d1910851c" title="Allows objects to be reoriented.">position_objects_panel_</a>-&gt;<a class="code" href="class_position_objects_panel.html#a4e3fb2608d3998ffecabe4f6c1a3ba89">showScaling</a>(); <span class="keywordflow">break</span>;
<a name="l00464"></a>00464         <span class="keywordflow">case</span> <a class="code" href="printableobjecthandle_8h.html#a21d45d7694b78139ec0345ff8a617732ab734c940cfcf9cf3901353f61ee7248f">kRotationHandles</a>:    <a class="code" href="class_main_window.html#adfab654511e443d02a0adc2d1910851c" title="Allows objects to be reoriented.">position_objects_panel_</a>-&gt;<a class="code" href="class_position_objects_panel.html#a553194ec5a2ebfd21955df9837cf5e9c">showRotation</a>(); <span class="keywordflow">break</span>;
<a name="l00465"></a>00465         <span class="keywordflow">case</span> <a class="code" href="printableobjecthandle_8h.html#a21d45d7694b78139ec0345ff8a617732a6385c619663d5d19061fecf0a0a9ce20">kTranslationHandles</a>:
<a name="l00466"></a>00466         <span class="keywordflow">case</span> <a class="code" href="printableobjecthandle_8h.html#a21d45d7694b78139ec0345ff8a617732a8917d769ea62d78a1b2f3f50c469f991">kTranslationHandles_NoZAxis</a>: <a class="code" href="class_main_window.html#adfab654511e443d02a0adc2d1910851c" title="Allows objects to be reoriented.">position_objects_panel_</a>-&gt;<a class="code" href="class_position_objects_panel.html#ac8851ccc4a75a82aaed40b1b7fdbd992">showTranslation</a>(); <span class="keywordflow">break</span>;
<a name="l00467"></a>00467         }
<a name="l00468"></a>00468       }
<a name="l00469"></a>00469 
<a name="l00470"></a>00470     } <span class="keywordflow">else</span> {
<a name="l00471"></a>00471 
<a name="l00472"></a>00472       <span class="comment">// Find a handle on some object to highlight when the mouse runs over it</span>
<a name="l00473"></a>00473 
<a name="l00474"></a>00474       <span class="comment">// Reset the currently selected axis</span>
<a name="l00475"></a>00475       <a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.axis = <a class="code" href="printableobjecthandle_8h.html#a5e33796668d54c255a99a1f64301fed6a6b7a2b2135ae2dc8e5c628cea727d1e0">kNoAxis</a>;
<a name="l00476"></a>00476 
<a name="l00477"></a>00477       <span class="keywordflow">if</span> (<a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.object) {
<a name="l00478"></a>00478 
<a name="l00479"></a>00479         <span class="comment">// Only test the active object</span>
<a name="l00480"></a>00480         <span class="keywordflow">if</span> (!<a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.object-&gt;pickHandle(eye,
<a name="l00481"></a>00481                                        gv,
<a name="l00482"></a>00482                                        <a class="code" href="class_main_window.html#a38a9f46d4a79cc78237ed0a4260dbded" title="Whether program is running in basic or advanced mode.">use_advanced_mode_</a>, <span class="comment">// only pick Z translate axis in advanced mode</span>
<a name="l00483"></a>00483                                        &amp;<a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.handle,
<a name="l00484"></a>00484                                        &amp;<a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.axis)) {
<a name="l00485"></a>00485           <span class="comment">// Reset the active object if the mouse strays too far from the bounding sphere</span>
<a name="l00486"></a>00486           <a class="code" href="struct_math_1_1_sphere.html">FAHSphere</a> big_sphere(<a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.object-&gt;boundingSphere());
<a name="l00487"></a>00487           big_sphere.radius *= 2.0f;
<a name="l00488"></a>00488           <span class="keywordflow">if</span> (!big_sphere.intersects(eye, gv)) {
<a name="l00489"></a>00489             <a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.object = 0;
<a name="l00490"></a>00490           }
<a name="l00491"></a>00491         }
<a name="l00492"></a>00492       }
<a name="l00493"></a>00493 
<a name="l00494"></a>00494       <span class="comment">// Check each object in the scene.  Pick the handle of the smallest object that it is</span>
<a name="l00495"></a>00495       <span class="comment">// over.  This allows objects within other objects to still be selected.</span>
<a name="l00496"></a>00496       <span class="keywordflow">foreach</span> (<a class="code" href="class_printable_object.html">PrintableObject</a>* <span class="keywordtype">object</span>, <a class="code" href="class_main_window.html#a2161c23e2b84b26d19c82faa2567d619" title="Each object in the scene.">printable_objects_</a>) {
<a name="l00497"></a>00497         <span class="keywordflow">if</span> (object-&gt;<a class="code" href="class_printable_object.html#a55116b31c83cf31af7a6bd659a60284d">pickHandle</a>(eye,
<a name="l00498"></a>00498                                gv,
<a name="l00499"></a>00499                                <a class="code" href="class_main_window.html#a38a9f46d4a79cc78237ed0a4260dbded" title="Whether program is running in basic or advanced mode.">use_advanced_mode_</a>, <span class="comment">// z translate axis in advanced mode only</span>
<a name="l00500"></a>00500                                &amp;<a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.handle,
<a name="l00501"></a>00501                                &amp;<a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.axis)) {
<a name="l00502"></a>00502           <span class="keywordflow">if</span> (!<a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.object ||
<a name="l00503"></a>00503                object-&gt;<a class="code" href="class_printable_object.html#a9b9006d5b0eb4c7e221416a4b66b163f">boundingSphere</a>().<a class="code" href="struct_math_1_1_sphere.html#a80bcacf256a1a429df0578650db6b195">radius</a> &lt; <a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.object-&gt;boundingSphere().radius) {
<a name="l00504"></a>00504             <a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.object = object;
<a name="l00505"></a>00505           }
<a name="l00506"></a>00506         }
<a name="l00507"></a>00507       }
<a name="l00508"></a>00508 
<a name="l00509"></a>00509       <span class="comment">// If no axis was found for any object, remove the selection display</span>
<a name="l00510"></a>00510       <span class="keywordflow">if</span> (<a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.axis == <a class="code" href="printableobjecthandle_8h.html#a5e33796668d54c255a99a1f64301fed6a6b7a2b2135ae2dc8e5c628cea727d1e0">kNoAxis</a>) {
<a name="l00511"></a>00511         <a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.handle = <a class="code" href="printableobjecthandle_8h.html#a21d45d7694b78139ec0345ff8a617732a85f88cbb351315d9a44fa5ba1f3e7711">kNoHandles</a>;
<a name="l00512"></a>00512       }
<a name="l00513"></a>00513     }
<a name="l00514"></a>00514 
<a name="l00515"></a>00515   }
<a name="l00516"></a>00516 
<a name="l00517"></a>00517   <span class="comment">// Make sure the scene is redrawn</span>
<a name="l00518"></a>00518   <a class="code" href="class_main_window.html#a807a36499c006fb8924b7f5d4257ec81">glRepaint</a>();
<a name="l00519"></a>00519 
<a name="l00520"></a>00520   <span class="comment">// Pick a shape for the cursor based on which handle, if any, is active</span>
<a name="l00521"></a>00521   Qt::CursorShape shape = Qt::ArrowCursor;
<a name="l00522"></a>00522   <span class="keywordflow">if</span> (!<a class="code" href="class_main_window.html#a7542af37381cff5cf5720f9e825938cd" title="Handles slicing/pathing/toolscript.">print_panel_</a>-&gt;<a class="code" href="class_print_panel.html#a028cf0c62ba0316b3ba594994e73c10d">isPrintInProgress</a>() &amp;&amp;
<a name="l00523"></a>00523       (<a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.axis != <a class="code" href="printableobjecthandle_8h.html#a5e33796668d54c255a99a1f64301fed6a6b7a2b2135ae2dc8e5c628cea727d1e0">kNoAxis</a>)) {
<a name="l00524"></a>00524     <span class="keywordflow">switch</span> (<a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.handle) {
<a name="l00525"></a>00525     <span class="keywordflow">default</span>:
<a name="l00526"></a>00526       <a class="code" href="confirm_8h.html#a849ce00d16854946d87935e0a66b0466">confirm</a> (<span class="keyword">false</span> &amp;&amp; <span class="stringliteral">&quot;Handle should always be valid if there is no axis&quot;</span>);
<a name="l00527"></a>00527     <span class="keywordflow">case</span> <a class="code" href="printableobjecthandle_8h.html#a21d45d7694b78139ec0345ff8a617732ad45205c093b02e925000e6d3faa22014">kScalingHandles</a>:
<a name="l00528"></a>00528     <span class="keywordflow">case</span> <a class="code" href="printableobjecthandle_8h.html#a21d45d7694b78139ec0345ff8a617732ab734c940cfcf9cf3901353f61ee7248f">kRotationHandles</a>:    shape = <a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.down ? Qt::ClosedHandCursor : Qt::OpenHandCursor; <span class="keywordflow">break</span>;
<a name="l00529"></a>00529     <span class="keywordflow">case</span> <a class="code" href="printableobjecthandle_8h.html#a21d45d7694b78139ec0345ff8a617732a6385c619663d5d19061fecf0a0a9ce20">kTranslationHandles</a>: shape = (<a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.axis == <a class="code" href="printableobjecthandle_8h.html#a5e33796668d54c255a99a1f64301fed6a4b4d0f97b370337b1c1bb0c78635a5d6">kZOnly</a>) ? Qt::SizeVerCursor : Qt::SizeAllCursor; <span class="keywordflow">break</span>;
<a name="l00530"></a>00530     <span class="keywordflow">case</span> <a class="code" href="printableobjecthandle_8h.html#a21d45d7694b78139ec0345ff8a617732a8917d769ea62d78a1b2f3f50c469f991">kTranslationHandles_NoZAxis</a>: shape = Qt::SizeAllCursor; <span class="keywordflow">break</span>;
<a name="l00531"></a>00531     }
<a name="l00532"></a>00532   }
<a name="l00533"></a>00533   <a class="code" href="class_main_window.html#af57701e45c39adf2a1a1f5ed16d79dba" title="This object controls the main OpenGL renderer and all visual 3d effects.">opengl_widget_</a>-&gt;setCursor(QCursor(shape));
<a name="l00534"></a>00534   <a class="code" href="class_main_window.html#a2cf42454562815dd44c716e78d515697">QMainWindow::mouseMoveEvent</a>(event);
<a name="l00535"></a>00535 }
<a name="l00536"></a>00536 
<a name="l00537"></a>00537 
<a name="l00538"></a><a class="code" href="class_main_window.html#a2b5463ae209a03d1680b39c950dac8be">00538</a> <span class="keywordtype">void</span> <a class="code" href="class_main_window.html#a2b5463ae209a03d1680b39c950dac8be">MainWindow::mousePressEvent</a>(QMouseEvent* event) {
<a name="l00539"></a>00539   QPoint p = <a class="code" href="class_main_window.html#af57701e45c39adf2a1a1f5ed16d79dba" title="This object controls the main OpenGL renderer and all visual 3d effects.">opengl_widget_</a>-&gt;mapFromGlobal(QCursor::pos());
<a name="l00540"></a>00540   <a class="code" href="class_open_g_l_camera.html">OpenGLCamera</a>* camera = <a class="code" href="class_main_window.html#af57701e45c39adf2a1a1f5ed16d79dba" title="This object controls the main OpenGL renderer and all visual 3d effects.">opengl_widget_</a>-&gt;<a class="code" href="class_open_g_l_widget.html#a4e4975d452ab06dd21717de6ffe1b362">camera</a>();
<a name="l00541"></a>00541   <a class="code" href="struct_math_1_1_vector3.html">FAHVector3</a> <a class="code" href="class_main_window.html#adce921150b6fcc23152fe4db53362a26">down_ray</a> = camera-&gt;<a class="code" href="class_open_g_l_camera.html#a8e4387490ef9e9af91c5e5d3c4e46e21">raycastFromScreen</a>(p.x(), p.y());
<a name="l00542"></a>00542 
<a name="l00543"></a>00543   <span class="keywordflow">if</span> (<a class="code" href="class_main_window.html#a4dc7f626c6584e20ae5ce588c79775aa">handleManipulationEnabled</a>()) {
<a name="l00544"></a>00544     <span class="keywordtype">bool</span> left = <span class="keyword">event</span>-&gt;buttons().testFlag(Qt::LeftButton);
<a name="l00545"></a>00545     <span class="keywordtype">bool</span> right = <span class="keyword">event</span>-&gt;buttons().testFlag(Qt::RightButton);
<a name="l00546"></a>00546     <span class="keywordflow">if</span> (right &amp;&amp; left &amp;&amp; <a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.object) {
<a name="l00547"></a>00547       <span class="comment">// cancel manipulating</span>
<a name="l00548"></a>00548       <a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.object-&gt;handleFinishManipulation(<span class="keyword">false</span>);
<a name="l00549"></a>00549       <a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.object = 0;
<a name="l00550"></a>00550       <a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.handle = <a class="code" href="printableobjecthandle_8h.html#a21d45d7694b78139ec0345ff8a617732a85f88cbb351315d9a44fa5ba1f3e7711">kNoHandles</a>;
<a name="l00551"></a>00551       <a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.axis = <a class="code" href="printableobjecthandle_8h.html#a5e33796668d54c255a99a1f64301fed6a6b7a2b2135ae2dc8e5c628cea727d1e0">kNoAxis</a>;
<a name="l00552"></a>00552     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (left &amp;&amp; <a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.object) {
<a name="l00553"></a>00553       <a class="code" href="class_main_window.html#a4b3bf8d42d0fabf05e956403c59e2b2c">selectObject</a>(<a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.object);
<a name="l00554"></a>00554       <a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.down = <span class="keyword">true</span>;
<a name="l00555"></a>00555       <a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.down_ray = down_ray;
<a name="l00556"></a>00556     }
<a name="l00557"></a>00557   }
<a name="l00558"></a>00558 
<a name="l00559"></a>00559   <a class="code" href="class_main_window.html#a2b5463ae209a03d1680b39c950dac8be">QMainWindow::mousePressEvent</a>(event);
<a name="l00560"></a>00560 }
<a name="l00561"></a>00561 
<a name="l00562"></a>00562 
<a name="l00563"></a><a class="code" href="class_main_window.html#a32bbb036a55856e49c31a5348f937b53">00563</a> <span class="keywordtype">void</span> <a class="code" href="class_main_window.html#a32bbb036a55856e49c31a5348f937b53">MainWindow::mouseReleaseEvent</a>(QMouseEvent* event) {
<a name="l00564"></a>00564   <a class="code" href="class_open_g_l_camera.html">OpenGLCamera</a>* camera = <a class="code" href="class_main_window.html#af57701e45c39adf2a1a1f5ed16d79dba" title="This object controls the main OpenGL renderer and all visual 3d effects.">opengl_widget_</a>-&gt;<a class="code" href="class_open_g_l_widget.html#a4e4975d452ab06dd21717de6ffe1b362">camera</a>();
<a name="l00565"></a>00565   QPoint p = <a class="code" href="class_main_window.html#af57701e45c39adf2a1a1f5ed16d79dba" title="This object controls the main OpenGL renderer and all visual 3d effects.">opengl_widget_</a>-&gt;mapFromGlobal(QCursor::pos());
<a name="l00566"></a>00566   <a class="code" href="struct_math_1_1_vector3.html">FAHVector3</a> ray = camera-&gt;<a class="code" href="class_open_g_l_camera.html#a8e4387490ef9e9af91c5e5d3c4e46e21">raycastFromScreen</a>(p.x(), p.y());
<a name="l00567"></a>00567 
<a name="l00568"></a>00568   <span class="keywordflow">if</span> (<a class="code" href="class_main_window.html#a4dc7f626c6584e20ae5ce588c79775aa">handleManipulationEnabled</a>() &amp;&amp;
<a name="l00569"></a>00569       !<span class="keyword">event</span>-&gt;buttons().testFlag(Qt::LeftButton)) {
<a name="l00570"></a>00570     <a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.down = <span class="keyword">false</span>;
<a name="l00571"></a>00571 
<a name="l00572"></a>00572     <span class="comment">// Apply transformations to the object</span>
<a name="l00573"></a>00573     <span class="keywordflow">if</span> (<a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.object) {
<a name="l00574"></a>00574       <a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.object-&gt;handleFinishManipulation(<span class="keyword">true</span>);
<a name="l00575"></a>00575 
<a name="l00576"></a>00576       <span class="comment">// Did they drop the object outside of the build area?</span>
<a name="l00577"></a>00577       <span class="keywordflow">if</span> (<a class="code" href="class_main_window.html#a2b321541b8ebe773323500833d9e3b73">isOffOfBuildTray</a>(<a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.object)) {
<a name="l00578"></a>00578         <a class="code" href="class_main_window.html#ab0410e7320602e41f07195fab2b0f528">removeObject</a>(<a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.object);
<a name="l00579"></a>00579       } <span class="keywordflow">else</span> {
<a name="l00580"></a>00580         <span class="comment">// In basic mode, automatically reposition the object after a rotation</span>
<a name="l00581"></a>00581         <span class="comment">// so that it rests on the build tray.</span>
<a name="l00582"></a>00582         <span class="keywordflow">if</span> ((<a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.handle == <a class="code" href="printableobjecthandle_8h.html#a21d45d7694b78139ec0345ff8a617732ab734c940cfcf9cf3901353f61ee7248f">kRotationHandles</a> ||
<a name="l00583"></a>00583              <a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.handle == <a class="code" href="printableobjecthandle_8h.html#a21d45d7694b78139ec0345ff8a617732ad45205c093b02e925000e6d3faa22014">kScalingHandles</a>) &amp;&amp; !<a class="code" href="class_main_window.html#a38a9f46d4a79cc78237ed0a4260dbded" title="Whether program is running in basic or advanced mode.">use_advanced_mode_</a>) {
<a name="l00584"></a>00584           <a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.object-&gt;snapToRestOnXYPlane();
<a name="l00585"></a>00585         }
<a name="l00586"></a>00586       }
<a name="l00587"></a>00587     }
<a name="l00588"></a>00588 
<a name="l00589"></a>00589     <span class="comment">// Reset the mouse information</span>
<a name="l00590"></a>00590     <a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.handle = <a class="code" href="printableobjecthandle_8h.html#a21d45d7694b78139ec0345ff8a617732a85f88cbb351315d9a44fa5ba1f3e7711">kNoHandles</a>;
<a name="l00591"></a>00591     <a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.axis = <a class="code" href="printableobjecthandle_8h.html#a5e33796668d54c255a99a1f64301fed6a6b7a2b2135ae2dc8e5c628cea727d1e0">kNoAxis</a>;
<a name="l00592"></a>00592 
<a name="l00593"></a>00593     <span class="comment">// Deselect the object if the mouse was released off of it</span>
<a name="l00594"></a>00594     <span class="keywordflow">if</span> (<a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.object != <a class="code" href="class_main_window.html#a2f996598d11f383730e14625b3d34edd" title="Object currently selected for editing (it has the handles!).">selected_object_</a> &amp;&amp;
<a name="l00595"></a>00595         <a class="code" href="class_main_window.html#a2f996598d11f383730e14625b3d34edd" title="Object currently selected for editing (it has the handles!).">selected_object_</a> &amp;&amp;
<a name="l00596"></a>00596         !<a class="code" href="class_main_window.html#a2f996598d11f383730e14625b3d34edd" title="Object currently selected for editing (it has the handles!).">selected_object_</a>-&gt;<a class="code" href="class_printable_object.html#a1d66ad7744ba8baf4310a8d80e45b279">intersectedByRay</a>(
<a name="l00597"></a>00597             camera-&gt;<a class="code" href="class_open_g_l_camera.html#a3e6ff57d1d2e5c559b4bddf660df15a3">getEye</a>(),
<a name="l00598"></a>00598             ray)) {
<a name="l00599"></a>00599       <a class="code" href="class_main_window.html#a4b3bf8d42d0fabf05e956403c59e2b2c">selectObject</a>(0);
<a name="l00600"></a>00600       <a class="code" href="class_main_window.html#a807a36499c006fb8924b7f5d4257ec81">glRepaint</a>();
<a name="l00601"></a>00601     }
<a name="l00602"></a>00602   }
<a name="l00603"></a>00603   <a class="code" href="class_main_window.html#a32bbb036a55856e49c31a5348f937b53">QMainWindow::mouseReleaseEvent</a>(event);
<a name="l00604"></a>00604 }
<a name="l00605"></a>00605 
<a name="l00606"></a>00606 
<a name="l00607"></a><a class="code" href="class_main_window.html#aa4eab0c94bb47c658d9141e13470f1d1">00607</a> <span class="keywordtype">void</span> <a class="code" href="class_main_window.html#aa4eab0c94bb47c658d9141e13470f1d1">MainWindow::mouseDoubleClickEvent</a>(QMouseEvent* event) {
<a name="l00608"></a>00608 
<a name="l00609"></a>00609   <span class="comment">// Snap to XY plane if double-click Z translate axis.  This is only</span>
<a name="l00610"></a>00610   <span class="comment">// visible in advanced mode, so we don&#39;t have to check for it otherwise.</span>
<a name="l00611"></a>00611   <span class="keywordflow">if</span> (<a class="code" href="class_main_window.html#a38a9f46d4a79cc78237ed0a4260dbded" title="Whether program is running in basic or advanced mode.">use_advanced_mode_</a> &amp;&amp; <a class="code" href="class_main_window.html#a4dc7f626c6584e20ae5ce588c79775aa">handleManipulationEnabled</a>()) {
<a name="l00612"></a>00612 
<a name="l00613"></a>00613     <span class="comment">// Get camera parameters</span>
<a name="l00614"></a>00614     <a class="code" href="class_open_g_l_camera.html">OpenGLCamera</a>* camera = <a class="code" href="class_main_window.html#af57701e45c39adf2a1a1f5ed16d79dba" title="This object controls the main OpenGL renderer and all visual 3d effects.">opengl_widget_</a>-&gt;<a class="code" href="class_open_g_l_widget.html#a4e4975d452ab06dd21717de6ffe1b362">camera</a>();
<a name="l00615"></a>00615     QPoint p = <a class="code" href="class_main_window.html#af57701e45c39adf2a1a1f5ed16d79dba" title="This object controls the main OpenGL renderer and all visual 3d effects.">opengl_widget_</a>-&gt;mapFromGlobal(QCursor::pos());
<a name="l00616"></a>00616     <a class="code" href="struct_math_1_1_vector3.html">FAHVector3</a> ray = camera-&gt;<a class="code" href="class_open_g_l_camera.html#a8e4387490ef9e9af91c5e5d3c4e46e21">raycastFromScreen</a>(p.x(), p.y());
<a name="l00617"></a>00617     <a class="code" href="struct_math_1_1_vector3.html">FAHVector3</a> eye = camera-&gt;<a class="code" href="class_open_g_l_camera.html#a3e6ff57d1d2e5c559b4bddf660df15a3">getEye</a>();
<a name="l00618"></a>00618 
<a name="l00619"></a>00619     <a class="code" href="printableobjecthandle_8h.html#a21d45d7694b78139ec0345ff8a617732">PrintableObjectHandleType</a> <a class="code" href="class_main_window.html#a70199929428e3655cf41c1701c9f9ff0">handle</a>;
<a name="l00620"></a>00620     <a class="code" href="printableobjecthandle_8h.html#a5e33796668d54c255a99a1f64301fed6">PrintableObjectHandleAxis</a> <a class="code" href="class_main_window.html#a44d1b4fb0eed788eb4f48c989d1659bd">axis</a>;
<a name="l00621"></a>00621     <span class="keywordflow">if</span> (<a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.object &amp;&amp; <a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.object-&gt;pickHandle(eye, ray, <span class="keyword">true</span>, &amp;handle, &amp;axis)) {
<a name="l00622"></a>00622       <span class="keywordflow">if</span> (handle == <a class="code" href="printableobjecthandle_8h.html#a21d45d7694b78139ec0345ff8a617732a6385c619663d5d19061fecf0a0a9ce20">kTranslationHandles</a> &amp;&amp; axis == <a class="code" href="printableobjecthandle_8h.html#a5e33796668d54c255a99a1f64301fed6a4b4d0f97b370337b1c1bb0c78635a5d6">kZOnly</a>) {
<a name="l00623"></a>00623         <span class="comment">// auto-snap to place on tray</span>
<a name="l00624"></a>00624         <a class="code" href="class_main_window.html#a8e93d136af33f8a8f9608105ccd5844c" title="When the mouse moves it changes these values. They are used for manipulation.">mouse_</a>.object-&gt;snapToRestOnXYPlane();
<a name="l00625"></a>00625       }
<a name="l00626"></a>00626     }
<a name="l00627"></a>00627   }
<a name="l00628"></a>00628 
<a name="l00629"></a>00629   <a class="code" href="class_main_window.html#a807a36499c006fb8924b7f5d4257ec81">glRepaint</a>();
<a name="l00630"></a>00630 
<a name="l00631"></a>00631   <a class="code" href="class_main_window.html#aa4eab0c94bb47c658d9141e13470f1d1">QMainWindow::mouseDoubleClickEvent</a>(event);
<a name="l00632"></a>00632 }
<a name="l00633"></a>00633 
<a name="l00634"></a>00634 
<a name="l00635"></a><a class="code" href="class_main_window.html#a9c4f542263838b9ecd06eae839a42a34">00635</a> <span class="keywordtype">void</span> <a class="code" href="class_main_window.html#a9c4f542263838b9ecd06eae839a42a34">MainWindow::keyPressEvent</a>(QKeyEvent* event) {
<a name="l00636"></a>00636   <span class="keywordtype">bool</span> shift = <span class="keyword">event</span>-&gt;modifiers().testFlag(Qt::ShiftModifier);
<a name="l00637"></a>00637   <span class="keywordflow">switch</span> (event-&gt;key()) {
<a name="l00638"></a>00638     <span class="keywordflow">case</span> Qt::Key_Delete:
<a name="l00639"></a>00639     <span class="keywordflow">case</span> Qt::Key_Backspace:
<a name="l00640"></a>00640       <span class="keywordflow">if</span> (<a class="code" href="class_main_window.html#a2f996598d11f383730e14625b3d34edd" title="Object currently selected for editing (it has the handles!).">selected_object_</a>) <a class="code" href="class_main_window.html#ab0410e7320602e41f07195fab2b0f528">removeObject</a>(<a class="code" href="class_main_window.html#a2f996598d11f383730e14625b3d34edd" title="Object currently selected for editing (it has the handles!).">selected_object_</a>);
<a name="l00641"></a>00641       <span class="keywordflow">break</span>;
<a name="l00642"></a>00642 
<a name="l00643"></a>00643     <span class="keywordflow">case</span> Qt::Key_Left:
<a name="l00644"></a>00644       <span class="keywordflow">if</span> (shift) <a class="code" href="class_main_window.html#af57701e45c39adf2a1a1f5ed16d79dba" title="This object controls the main OpenGL renderer and all visual 3d effects.">opengl_widget_</a>-&gt;<a class="code" href="class_open_g_l_widget.html#a3e646a24fd85bca260bb3d45b4a2ed48">rotate</a>(-0.15); <span class="keywordflow">else</span> <a class="code" href="class_main_window.html#af57701e45c39adf2a1a1f5ed16d79dba" title="This object controls the main OpenGL renderer and all visual 3d effects.">opengl_widget_</a>-&gt;<a class="code" href="class_open_g_l_widget.html#a96ee0b16f77a005cb4e96bd714b71512">nudge</a>(-10.0f, 0.0f);
<a name="l00645"></a>00645       <span class="keywordflow">break</span>;
<a name="l00646"></a>00646 
<a name="l00647"></a>00647     <span class="keywordflow">case</span> Qt::Key_Right:
<a name="l00648"></a>00648       <span class="keywordflow">if</span> (shift) <a class="code" href="class_main_window.html#af57701e45c39adf2a1a1f5ed16d79dba" title="This object controls the main OpenGL renderer and all visual 3d effects.">opengl_widget_</a>-&gt;<a class="code" href="class_open_g_l_widget.html#a3e646a24fd85bca260bb3d45b4a2ed48">rotate</a>(+0.15); <span class="keywordflow">else</span> <a class="code" href="class_main_window.html#af57701e45c39adf2a1a1f5ed16d79dba" title="This object controls the main OpenGL renderer and all visual 3d effects.">opengl_widget_</a>-&gt;<a class="code" href="class_open_g_l_widget.html#a96ee0b16f77a005cb4e96bd714b71512">nudge</a>(+10.0f, 0.0f);
<a name="l00649"></a>00649       <span class="keywordflow">break</span>;
<a name="l00650"></a>00650 
<a name="l00651"></a>00651     <span class="keywordflow">case</span> Qt::Key_Up:
<a name="l00652"></a>00652       <span class="keywordflow">if</span> (shift) <a class="code" href="class_main_window.html#af57701e45c39adf2a1a1f5ed16d79dba" title="This object controls the main OpenGL renderer and all visual 3d effects.">opengl_widget_</a>-&gt;<a class="code" href="class_open_g_l_widget.html#a5603a129abf7c7b8bc0b1be92a9637d6">addZoom</a>(+0.1); <span class="keywordflow">else</span> <a class="code" href="class_main_window.html#af57701e45c39adf2a1a1f5ed16d79dba" title="This object controls the main OpenGL renderer and all visual 3d effects.">opengl_widget_</a>-&gt;<a class="code" href="class_open_g_l_widget.html#a96ee0b16f77a005cb4e96bd714b71512">nudge</a>(0.0f, -10.0f);
<a name="l00653"></a>00653       <span class="keywordflow">break</span>;
<a name="l00654"></a>00654 
<a name="l00655"></a>00655     <span class="keywordflow">case</span> Qt::Key_Down:
<a name="l00656"></a>00656       <span class="keywordflow">if</span> (shift) <a class="code" href="class_main_window.html#af57701e45c39adf2a1a1f5ed16d79dba" title="This object controls the main OpenGL renderer and all visual 3d effects.">opengl_widget_</a>-&gt;<a class="code" href="class_open_g_l_widget.html#a5603a129abf7c7b8bc0b1be92a9637d6">addZoom</a>(-0.1); <span class="keywordflow">else</span> <a class="code" href="class_main_window.html#af57701e45c39adf2a1a1f5ed16d79dba" title="This object controls the main OpenGL renderer and all visual 3d effects.">opengl_widget_</a>-&gt;<a class="code" href="class_open_g_l_widget.html#a96ee0b16f77a005cb4e96bd714b71512">nudge</a>(0.0f, +10.0f);
<a name="l00657"></a>00657       <span class="keywordflow">break</span>;
<a name="l00658"></a>00658   }
<a name="l00659"></a>00659 }
<a name="l00660"></a>00660 
<a name="l00661"></a>00661 
<a name="l00662"></a>00662 
<a name="l00663"></a><a class="code" href="class_main_window.html#a4dc7f626c6584e20ae5ce588c79775aa">00663</a> <span class="keywordtype">bool</span> <a class="code" href="class_main_window.html#a4dc7f626c6584e20ae5ce588c79775aa">MainWindow::handleManipulationEnabled</a>()<span class="keyword"> const </span>{
<a name="l00664"></a>00664   <span class="keywordflow">return</span> !<a class="code" href="class_main_window.html#a7542af37381cff5cf5720f9e825938cd" title="Handles slicing/pathing/toolscript.">print_panel_</a>-&gt;<a class="code" href="class_print_panel.html#a028cf0c62ba0316b3ba594994e73c10d">isPrintInProgress</a>();
<a name="l00665"></a>00665 }
<a name="l00666"></a>00666 
<a name="l00667"></a><a class="code" href="class_main_window.html#a807a36499c006fb8924b7f5d4257ec81">00667</a> <span class="keywordtype">void</span> <a class="code" href="class_main_window.html#a807a36499c006fb8924b7f5d4257ec81">MainWindow::glRepaint</a>() {
<a name="l00668"></a>00668   <span class="keywordflow">if</span> (<a class="code" href="class_main_window.html#a9deff61d24d2fdfb2341043ae489ef70">gl_repaint_timer_</a>.isActive()) {
<a name="l00669"></a>00669     <span class="keywordflow">return</span>;
<a name="l00670"></a>00670   }
<a name="l00671"></a>00671   <a class="code" href="class_main_window.html#af57701e45c39adf2a1a1f5ed16d79dba" title="This object controls the main OpenGL renderer and all visual 3d effects.">opengl_widget_</a>-&gt;repaint();
<a name="l00672"></a>00672   <a class="code" href="class_main_window.html#a9deff61d24d2fdfb2341043ae489ef70">gl_repaint_timer_</a>.setSingleShot(<span class="keyword">true</span>);
<a name="l00673"></a>00673   <a class="code" href="class_main_window.html#a9deff61d24d2fdfb2341043ae489ef70">gl_repaint_timer_</a>.start(1000/60);
<a name="l00674"></a>00674 }
<a name="l00675"></a>00675 
<a name="l00676"></a>00676 
<a name="l00677"></a><a class="code" href="class_main_window.html#a3159ee228ade18762d9cd2adc7650f9c">00677</a> <span class="keywordtype">void</span> <a class="code" href="class_main_window.html#a3159ee228ade18762d9cd2adc7650f9c">MainWindow::updateCheckMarks</a>() {
<a name="l00678"></a>00678   <span class="keywordtype">bool</span> load_objects = !<a class="code" href="class_main_window.html#a2161c23e2b84b26d19c82faa2567d619" title="Each object in the scene.">printable_objects_</a>.isEmpty();
<a name="l00679"></a>00679   <span class="keywordtype">bool</span> assign_materials = <a class="code" href="class_main_window.html#aec895b8e58ffab015e5901f1cf5f3710">allObjectsHaveMaterials</a>();
<a name="l00680"></a>00680   <span class="keywordtype">bool</span> send_to_printer = <span class="keyword">false</span>;
<a name="l00681"></a>00681   <a class="code" href="class_main_window.html#ae33c89fc0b34d28d8a7c22e9f06d2f2d" title="Provides a breadcrumb of buttons.">toolbar_</a>-&gt;<a class="code" href="class_toolbar.html#a104da8d94f7269444c44efb4b7fd3db3">setCheckMarks</a>(load_objects,
<a name="l00682"></a>00682                           assign_materials,
<a name="l00683"></a>00683                           send_to_printer);
<a name="l00684"></a>00684 
<a name="l00685"></a>00685 
<a name="l00686"></a>00686   <span class="comment">// Only enable panels once their prereqs have been fulfilled.</span>
<a name="l00687"></a>00687   <span class="comment">// Disabling is IMPORTANT because even though the panels are</span>
<a name="l00688"></a>00688   <span class="comment">// closed, the user can right-click the toolbar to bring</span>
<a name="l00689"></a>00689   <span class="comment">// them back...and there&#39;s not much we can do to stop that.</span>
<a name="l00690"></a>00690 
<a name="l00691"></a>00691   <span class="comment">// need objects before materials / position objects</span>
<a name="l00692"></a>00692   <span class="keywordtype">bool</span> object_editing_panels_enabled = load_objects;
<a name="l00693"></a>00693   <span class="keywordflow">if</span> (!object_editing_panels_enabled) {
<a name="l00694"></a>00694     <a class="code" href="class_main_window.html#adfab654511e443d02a0adc2d1910851c" title="Allows objects to be reoriented.">position_objects_panel_</a>-&gt;close();
<a name="l00695"></a>00695     <a class="code" href="class_main_window.html#ab2b954f1b53302af498f9f83948f3fa5" title="Allows objects to be given printing materials.">materials_panel_</a>-&gt;close();
<a name="l00696"></a>00696   }
<a name="l00697"></a>00697   <a class="code" href="class_main_window.html#adfab654511e443d02a0adc2d1910851c" title="Allows objects to be reoriented.">position_objects_panel_</a>-&gt;setEnabled(object_editing_panels_enabled);
<a name="l00698"></a>00698   <a class="code" href="class_main_window.html#ab2b954f1b53302af498f9f83948f3fa5" title="Allows objects to be given printing materials.">materials_panel_</a>-&gt;setEnabled(object_editing_panels_enabled);
<a name="l00699"></a>00699 
<a name="l00700"></a>00700   <span class="comment">// need objects w/ materials before printing</span>
<a name="l00701"></a>00701   <span class="keywordtype">bool</span> print_panel_enabled = load_objects &amp;&amp; assign_materials;
<a name="l00702"></a>00702   <span class="keywordflow">if</span> (!print_panel_enabled) <a class="code" href="class_main_window.html#a7542af37381cff5cf5720f9e825938cd" title="Handles slicing/pathing/toolscript.">print_panel_</a>-&gt;close();
<a name="l00703"></a>00703   <a class="code" href="class_main_window.html#a7542af37381cff5cf5720f9e825938cd" title="Handles slicing/pathing/toolscript.">print_panel_</a>-&gt;setEnabled(print_panel_enabled);
<a name="l00704"></a>00704 
<a name="l00705"></a>00705   <span class="comment">// This disables or enables menu items based on the scene</span>
<a name="l00706"></a>00706   <span class="comment">// Search by an index or something, rather than having to do a</span>
<a name="l00707"></a>00707   <span class="comment">// big for... loop</span>
<a name="l00708"></a>00708   <a class="code" href="todo_8h.html#ae61a00cdcabcd21f703f7ad228eb25db">todo</a>(<span class="stringliteral">&quot;kwg8&quot;</span>,<span class="stringliteral">&quot;Find items in the View menu less hackishly&quot;</span>);
<a name="l00709"></a>00709   <span class="keywordflow">foreach</span> (QAction* action, <a class="code" href="class_main_window.html#a35466a70ed47252a0191168126a352a5">ui</a>-&gt;<a class="code" href="class_ui___main_window.html#a9e7f2ce6c3d8a309109baed7d6890604">menuView</a>-&gt;actions()) {
<a name="l00710"></a>00710     <span class="keywordflow">if</span> (action-&gt;text() == <a class="code" href="class_main_window.html#adfab654511e443d02a0adc2d1910851c" title="Allows objects to be reoriented.">position_objects_panel_</a>-&gt;windowTitle()) {
<a name="l00711"></a>00711       action-&gt;setEnabled(object_editing_panels_enabled);
<a name="l00712"></a>00712     }
<a name="l00713"></a>00713     <span class="keywordflow">if</span> (action-&gt;text() == <a class="code" href="class_main_window.html#ab2b954f1b53302af498f9f83948f3fa5" title="Allows objects to be given printing materials.">materials_panel_</a>-&gt;windowTitle()) {
<a name="l00714"></a>00714       action-&gt;setEnabled(object_editing_panels_enabled);
<a name="l00715"></a>00715     }
<a name="l00716"></a>00716     <span class="keywordflow">if</span> (action-&gt;text() == <a class="code" href="class_main_window.html#a7542af37381cff5cf5720f9e825938cd" title="Handles slicing/pathing/toolscript.">print_panel_</a>-&gt;windowTitle()) {
<a name="l00717"></a>00717       action-&gt;setEnabled(print_panel_enabled);
<a name="l00718"></a>00718     }
<a name="l00719"></a>00719   }
<a name="l00720"></a>00720 }
<a name="l00721"></a>00721 
<a name="l00722"></a>00722 
<a name="l00723"></a><a class="code" href="class_main_window.html#ab948ab642e306eededb8f1c067f8a40b">00723</a> <span class="keywordtype">void</span> <a class="code" href="class_main_window.html#ab948ab642e306eededb8f1c067f8a40b">MainWindow::arrangeBuildTray</a>() {
<a name="l00724"></a>00724 
<a name="l00725"></a>00725   { <span class="comment">// Re-orient each object</span>
<a name="l00726"></a>00726     QMutexLocker locker(&amp;<a class="code" href="class_main_window.html#a8248124ea53e3f8a59e9cdbd68f0c353">printable_objects_mutex_</a>);
<a name="l00727"></a>00727     <span class="keywordflow">foreach</span> (<a class="code" href="class_printable_object.html">PrintableObject</a>* <span class="keywordtype">object</span>, <a class="code" href="class_main_window.html#a2161c23e2b84b26d19c82faa2567d619" title="Each object in the scene.">printable_objects_</a>) {
<a name="l00728"></a>00728       <span class="keywordtype">object</span>-&gt;setBestOrientation();
<a name="l00729"></a>00729     }
<a name="l00730"></a>00730   }
<a name="l00731"></a>00731 
<a name="l00732"></a>00732   <span class="comment">// Find the footprints of the objects</span>
<a name="l00733"></a>00733   QList&lt;FAHLoopInXYPlane&gt; footprints;
<a name="l00734"></a>00734   {
<a name="l00735"></a>00735     <a class="code" href="todo_8h.html#ae61a00cdcabcd21f703f7ad228eb25db">todo</a>(<span class="stringliteral">&quot;kwg8&quot;</span>, <span class="stringliteral">&quot;find better footprints; for now just use the bounding sphere&quot;</span>);
<a name="l00736"></a>00736     QMutexLocker locker(&amp;<a class="code" href="class_main_window.html#a8248124ea53e3f8a59e9cdbd68f0c353">printable_objects_mutex_</a>);
<a name="l00737"></a>00737     <span class="keywordflow">foreach</span> (<a class="code" href="class_printable_object.html">PrintableObject</a>* <span class="keywordtype">object</span>, <a class="code" href="class_main_window.html#a2161c23e2b84b26d19c82faa2567d619" title="Each object in the scene.">printable_objects_</a>) {
<a name="l00738"></a>00738       <span class="keyword">const</span> <a class="code" href="struct_math_1_1_sphere.html">FAHSphere</a>&amp; sphere = <span class="keywordtype">object</span>-&gt;boundingSphere();
<a name="l00739"></a>00739       <span class="keyword">const</span> <span class="keywordtype">float</span> r = sphere.<a class="code" href="struct_math_1_1_sphere.html#a80bcacf256a1a429df0578650db6b195">radius</a>;
<a name="l00740"></a>00740       <a class="code" href="struct_math_1_1_loop_in_x_y_plane.html">FAHLoopInXYPlane</a> footprint;
<a name="l00741"></a>00741       footprint.<a class="code" href="struct_math_1_1_loop_in_x_y_plane.html#a3e06be8852b3319ee4552d738b3b72c1">add</a>(sphere.<a class="code" href="struct_math_1_1_sphere.html#a763d0c0d1886d0fbc2ceb2ba9450df70">center</a>.copy().add(<a class="code" href="struct_math_1_1_vector3.html#adb53c2fbf1b9b166c215629d954ecc24">FAHVector3::make</a>(-r,-r,0)));
<a name="l00742"></a>00742       footprint.<a class="code" href="struct_math_1_1_loop_in_x_y_plane.html#a3e06be8852b3319ee4552d738b3b72c1">add</a>(sphere.<a class="code" href="struct_math_1_1_sphere.html#a763d0c0d1886d0fbc2ceb2ba9450df70">center</a>.copy().add(<a class="code" href="struct_math_1_1_vector3.html#adb53c2fbf1b9b166c215629d954ecc24">FAHVector3::make</a>(-r,+r,0)));
<a name="l00743"></a>00743       footprint.<a class="code" href="struct_math_1_1_loop_in_x_y_plane.html#a3e06be8852b3319ee4552d738b3b72c1">add</a>(sphere.<a class="code" href="struct_math_1_1_sphere.html#a763d0c0d1886d0fbc2ceb2ba9450df70">center</a>.copy().add(<a class="code" href="struct_math_1_1_vector3.html#adb53c2fbf1b9b166c215629d954ecc24">FAHVector3::make</a>(+r,+r,0)));
<a name="l00744"></a>00744       footprint.<a class="code" href="struct_math_1_1_loop_in_x_y_plane.html#a3e06be8852b3319ee4552d738b3b72c1">add</a>(sphere.<a class="code" href="struct_math_1_1_sphere.html#a763d0c0d1886d0fbc2ceb2ba9450df70">center</a>.copy().add(<a class="code" href="struct_math_1_1_vector3.html#adb53c2fbf1b9b166c215629d954ecc24">FAHVector3::make</a>(+r,-r,0)));
<a name="l00745"></a>00745       footprints.append(footprint);
<a name="l00746"></a>00746     }
<a name="l00747"></a>00747   }
<a name="l00748"></a>00748 
<a name="l00749"></a>00749   <span class="comment">// Get the build tray layout</span>
<a name="l00750"></a>00750   <a class="code" href="todo_8h.html#ae61a00cdcabcd21f703f7ad228eb25db">todo</a>(<span class="stringliteral">&quot;kwg8&quot;</span>, <span class="stringliteral">&quot;Set the correct build area width based on printer setting&quot;</span>);
<a name="l00751"></a>00751   <span class="keywordtype">float</span> build_area_width_ = 250.0f;
<a name="l00752"></a>00752   QList&lt;PositionAndOrientation&gt; layout =<a class="code" href="class_main_window.html#ab948ab642e306eededb8f1c067f8a40b"> ::arrangeBuildTray</a>(footprints, build_area_width_);
<a name="l00753"></a>00753 
<a name="l00754"></a>00754   <span class="comment">// Assign the layout</span>
<a name="l00755"></a>00755   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; layout.size(); ++i) {
<a name="l00756"></a>00756     <span class="keyword">const</span> <a class="code" href="struct_position_and_orientation.html">PositionAndOrientation</a>&amp; item = layout.at(i);
<a name="l00757"></a>00757     <a class="code" href="class_printable_object.html">PrintableObject</a>* <span class="keywordtype">object</span> = <a class="code" href="class_main_window.html#a2161c23e2b84b26d19c82faa2567d619" title="Each object in the scene.">printable_objects_</a>[i];
<a name="l00758"></a>00758     <span class="keywordtype">object</span>-&gt;translateAbsolute(<a class="code" href="struct_math_1_1_vector3.html#adb53c2fbf1b9b166c215629d954ecc24">FAHVector3::make</a>(item.<a class="code" href="struct_position_and_orientation.html#a7370c72ddc532b082b05b57642ecf130">x</a>, item.<a class="code" href="struct_position_and_orientation.html#a975fdfa782316b5c7245e6b71bcb9a0c">y</a>, 0.0f));
<a name="l00759"></a>00759     <a class="code" href="todo_8h.html#ae61a00cdcabcd21f703f7ad228eb25db">todo</a>(<span class="stringliteral">&quot;kwg8&quot;</span>, <span class="stringliteral">&quot;set the rotation of the object&quot;</span>);
<a name="l00760"></a>00760     <span class="keywordtype">object</span>-&gt;snapToRestOnXYPlane();
<a name="l00761"></a>00761   }
<a name="l00762"></a>00762 
<a name="l00763"></a>00763   <span class="keywordflow">if</span> (<a class="code" href="class_main_window.html#a2f996598d11f383730e14625b3d34edd" title="Object currently selected for editing (it has the handles!).">selected_object_</a>) {
<a name="l00764"></a>00764     <a class="code" href="class_main_window.html#adfab654511e443d02a0adc2d1910851c" title="Allows objects to be reoriented.">position_objects_panel_</a>-&gt;<a class="code" href="class_position_objects_panel.html#adb3c01eb1bef1a0dd04603073b615f06">manipulatedObject</a>(<a class="code" href="class_main_window.html#a2f996598d11f383730e14625b3d34edd" title="Object currently selected for editing (it has the handles!).">selected_object_</a>);
<a name="l00765"></a>00765   }
<a name="l00766"></a>00766 
<a name="l00767"></a>00767   <a class="code" href="class_main_window.html#a807a36499c006fb8924b7f5d4257ec81">glRepaint</a>();
<a name="l00768"></a>00768 }
<a name="l00769"></a>00769 
<a name="l00770"></a>00770 
<a name="l00771"></a><a class="code" href="class_main_window.html#a813257b32ad431a9a4994fa1c1dfd407">00771</a> QMultiMap&lt;QString,AMFRegion*&gt; <a class="code" href="class_main_window.html#a813257b32ad431a9a4994fa1c1dfd407">MainWindow::getMaterialNameToPrintableMeshMap</a>() {
<a name="l00772"></a>00772   QMutexLocker locker(&amp;<a class="code" href="class_main_window.html#a8248124ea53e3f8a59e9cdbd68f0c353">printable_objects_mutex_</a>);
<a name="l00773"></a>00773   QMultiMap&lt;QString,AMFRegion*&gt; map;
<a name="l00774"></a>00774   <span class="keywordflow">foreach</span> (<a class="code" href="class_printable_object.html">PrintableObject</a>* <span class="keywordtype">object</span>, <a class="code" href="class_main_window.html#a2161c23e2b84b26d19c82faa2567d619" title="Each object in the scene.">printable_objects_</a>) {
<a name="l00775"></a>00775 
<a name="l00776"></a>00776     <span class="comment">// Make sure the mesh has been constructed</span>
<a name="l00777"></a>00777     <span class="keywordtype">object</span>-&gt;buildPrintableMesh();
<a name="l00778"></a>00778 
<a name="l00779"></a>00779     <span class="comment">// Add the mapping to our output set</span>
<a name="l00780"></a>00780     map.unite(object-&gt;<a class="code" href="class_printable_object.html#a06dfb95e4a1e58f4817a971f09b1fe7f">getMaterialNameToPrintableMeshMap</a>());
<a name="l00781"></a>00781   }
<a name="l00782"></a>00782   <span class="keywordflow">return</span> map;
<a name="l00783"></a>00783 }
<a name="l00784"></a>00784 
<a name="l00785"></a>00785 
<a name="l00786"></a><a class="code" href="class_main_window.html#adfa362b12ec71954709543ca552f4279">00786</a> <span class="keywordtype">void</span> <a class="code" href="class_main_window.html#adfa362b12ec71954709543ca552f4279">MainWindow::useAdvancedMode</a>(<span class="keywordtype">bool</span> enable) {
<a name="l00787"></a>00787   QSettings settings;
<a name="l00788"></a>00788   settings.setValue(<a class="code" href="mainwindow_8cpp.html#acad3eb6382b41bd0fad76b7afa427b8d">kAdvancedModeSettingKey</a>, enable);
<a name="l00789"></a>00789   <span class="keywordflow">if</span> (<a class="code" href="class_main_window.html#a38a9f46d4a79cc78237ed0a4260dbded" title="Whether program is running in basic or advanced mode.">use_advanced_mode_</a> &amp;&amp; !enable) {
<a name="l00790"></a>00790     <span class="comment">// set everything to rest on the build tray</span>
<a name="l00791"></a>00791     <span class="keywordflow">foreach</span> (<a class="code" href="class_printable_object.html">PrintableObject</a>* <span class="keywordtype">object</span>, <a class="code" href="class_main_window.html#a2161c23e2b84b26d19c82faa2567d619" title="Each object in the scene.">printable_objects_</a>) {
<a name="l00792"></a>00792       <span class="keywordtype">object</span>-&gt;snapToRestOnXYPlane();
<a name="l00793"></a>00793     }
<a name="l00794"></a>00794     <a class="code" href="class_main_window.html#a807a36499c006fb8924b7f5d4257ec81">glRepaint</a>();
<a name="l00795"></a>00795   }
<a name="l00796"></a>00796   <a class="code" href="class_main_window.html#a38a9f46d4a79cc78237ed0a4260dbded" title="Whether program is running in basic or advanced mode.">use_advanced_mode_</a> = enable;
<a name="l00797"></a>00797   <a class="code" href="class_main_window.html#ae63126f188819c07771852e0a4b91f6b" title="Provides ways of bringing objects into the scene.">load_objects_panel_</a>-&gt;<a class="code" href="class_load_objects_panel.html#a746f4526ef2bac843f8da4eb391d765b">useAdvancedMode</a>(enable);
<a name="l00798"></a>00798   <a class="code" href="class_main_window.html#adfab654511e443d02a0adc2d1910851c" title="Allows objects to be reoriented.">position_objects_panel_</a>-&gt;<a class="code" href="class_position_objects_panel.html#a93c7cb492adc952682c155b1b5c03e0f">useAdvancedMode</a>(enable);
<a name="l00799"></a>00799   <a class="code" href="class_main_window.html#a7542af37381cff5cf5720f9e825938cd" title="Handles slicing/pathing/toolscript.">print_panel_</a>-&gt;<a class="code" href="class_print_panel.html#a8f95b4a3b6d89a11ebeddc8c7109a8d5">useAdvancedMode</a>(enable);
<a name="l00800"></a>00800   <a class="code" href="class_main_window.html#ab2b954f1b53302af498f9f83948f3fa5" title="Allows objects to be given printing materials.">materials_panel_</a>-&gt;<a class="code" href="class_materials_panel.html#a3a3104e6e36ba7e979aee2b407ac73c7">useAdvancedMode</a>(enable);
<a name="l00801"></a>00801 }
<a name="l00802"></a>00802 
<a name="l00803"></a>00803 
<a name="l00804"></a><a class="code" href="class_main_window.html#aec895b8e58ffab015e5901f1cf5f3710">00804</a> <span class="keywordtype">bool</span> <a class="code" href="class_main_window.html#aec895b8e58ffab015e5901f1cf5f3710">MainWindow::allObjectsHaveMaterials</a>()<span class="keyword"> const </span>{
<a name="l00805"></a>00805   <span class="keywordtype">bool</span> all = !<a class="code" href="class_main_window.html#a2161c23e2b84b26d19c82faa2567d619" title="Each object in the scene.">printable_objects_</a>.isEmpty();
<a name="l00806"></a>00806   <span class="keywordflow">foreach</span> (<a class="code" href="class_printable_object.html">PrintableObject</a>* po, <a class="code" href="class_main_window.html#a2161c23e2b84b26d19c82faa2567d619" title="Each object in the scene.">printable_objects_</a>) {
<a name="l00807"></a>00807     all = all &amp;&amp; po-&gt;<a class="code" href="class_printable_object.html#a0e8e52c14e76e241400728d01cca066d">hasCompleteMaterialAssignment</a>();
<a name="l00808"></a>00808   }
<a name="l00809"></a>00809   <span class="keywordflow">return</span> all;
<a name="l00810"></a>00810 }
<a name="l00811"></a>00811 
<a name="l00812"></a>00812 
<a name="l00813"></a><a class="code" href="class_main_window.html#a18c2a03d7b02467d21bc6440dada64a2">00813</a> <span class="keywordtype">void</span> <a class="code" href="class_main_window.html#a18c2a03d7b02467d21bc6440dada64a2">MainWindow::checkFirstExecution</a>() {
<a name="l00814"></a>00814   QSettings settings;
<a name="l00815"></a>00815   <span class="keywordflow">if</span> (settings.value(<a class="code" href="mainwindow_8cpp.html#a18c4d0bf5dbe1f9fe1f3f142714f582f">kFirstExecutionSettingKey</a>, <span class="keyword">true</span>).toBool() ||
<a name="l00816"></a>00816       settings.value(<a class="code" href="mainwindow_8cpp.html#a30721e11c6fda03a29293f88e2354778">kAlwaysShowStartupInformationSettingKey</a>, <span class="keyword">false</span>).toBool()) {
<a name="l00817"></a>00817 
<a name="l00818"></a>00818     <span class="comment">// run the first execution dialog</span>
<a name="l00819"></a>00819     <a class="code" href="class_first_execution_dialog.html">FirstExecutionDialog</a> dialog;
<a name="l00820"></a>00820     dialog.exec();
<a name="l00821"></a>00821   }
<a name="l00822"></a>00822   settings.setValue(<a class="code" href="mainwindow_8cpp.html#a18c4d0bf5dbe1f9fe1f3f142714f582f">kFirstExecutionSettingKey</a>, <span class="keyword">false</span>);
<a name="l00823"></a>00823 }
<a name="l00824"></a>00824 
<a name="l00825"></a>00825 
<a name="l00826"></a><a class="code" href="class_main_window.html#a2b321541b8ebe773323500833d9e3b73">00826</a> <span class="keywordtype">bool</span> <a class="code" href="class_main_window.html#a2b321541b8ebe773323500833d9e3b73">MainWindow::isOffOfBuildTray</a>(<span class="keyword">const</span> <a class="code" href="class_printable_object.html">PrintableObject</a>* <span class="keywordtype">object</span>)<span class="keyword"> const </span>{
<a name="l00827"></a>00827   <span class="keyword">const</span> <a class="code" href="struct_math_1_1_sphere.html">FAHSphere</a>&amp; sphere = <span class="keywordtype">object</span>-&gt;boundingSphere();
<a name="l00828"></a>00828   <span class="keywordflow">return</span> sphere.<a class="code" href="struct_math_1_1_sphere.html#a80bcacf256a1a429df0578650db6b195">radius</a> + sphere.<a class="code" href="struct_math_1_1_sphere.html#a763d0c0d1886d0fbc2ceb2ba9450df70">center</a>.x &lt; 0 ||
<a name="l00829"></a>00829          sphere.<a class="code" href="struct_math_1_1_sphere.html#a80bcacf256a1a429df0578650db6b195">radius</a> + sphere.<a class="code" href="struct_math_1_1_sphere.html#a763d0c0d1886d0fbc2ceb2ba9450df70">center</a>.y &lt; 0;
<a name="l00830"></a>00830 }
<a name="l00831"></a>00831 
<a name="l00832"></a>00832 
<a name="l00833"></a><a class="code" href="class_main_window.html#a2d8be3528b0abd745a09f9731919f891">00833</a> <span class="keywordtype">bool</span> <a class="code" href="class_main_window.html#a2b321541b8ebe773323500833d9e3b73">MainWindow::isOffOfBuildTray</a>(<span class="keyword">const</span> <a class="code" href="struct_math_1_1_vector3.html">FAHVector3</a>&amp; location)<span class="keyword"> const </span>{
<a name="l00834"></a>00834   <span class="keywordflow">return</span> location.<a class="code" href="struct_math_1_1_vector3.html#aae835fbe51212f299df619a902f9296c">x</a> &lt; 0 || location.<a class="code" href="struct_math_1_1_vector3.html#a09e80ead9117655b11803566070f70f6">y</a> &lt; 0;
<a name="l00835"></a>00835 }
<a name="l00836"></a>00836 
<a name="l00837"></a>00837 
<a name="l00838"></a><a class="code" href="class_main_window.html#a42df95d1ff214ff5e46c048c132b5048">00838</a> <span class="keywordtype">bool</span> <a class="code" href="class_main_window.html#a42df95d1ff214ff5e46c048c132b5048">MainWindow::isInAdvancedMode</a>()<span class="keyword"> const </span>{
<a name="l00839"></a>00839   <span class="keywordflow">return</span> <a class="code" href="class_main_window.html#a38a9f46d4a79cc78237ed0a4260dbded" title="Whether program is running in basic or advanced mode.">use_advanced_mode_</a>;
<a name="l00840"></a>00840 }
<a name="l00841"></a>00841 
<a name="l00842"></a>00842 
<a name="l00843"></a><a class="code" href="class_main_window.html#a86dee639709c4c8a14416b7fff63f8d0">00843</a> <span class="keywordtype">void</span> <a class="code" href="class_main_window.html#a86dee639709c4c8a14416b7fff63f8d0">MainWindow::graphicsViewUpdateSize</a>() {
<a name="l00844"></a>00844   <a class="code" href="class_main_window.html#af57701e45c39adf2a1a1f5ed16d79dba" title="This object controls the main OpenGL renderer and all visual 3d effects.">opengl_widget_</a>-&gt;resize(<a class="code" href="class_main_window.html#a35466a70ed47252a0191168126a352a5">ui</a>-&gt;<a class="code" href="class_ui___main_window.html#a713d8e541d9de8389ad4292131dc931a">graphicsView</a>-&gt;size());
<a name="l00845"></a>00845   <a class="code" href="class_main_window.html#a807a36499c006fb8924b7f5d4257ec81">glRepaint</a>();
<a name="l00846"></a>00846 }
<a name="l00847"></a>00847 
<a name="l00848"></a>00848 
<a name="l00849"></a><a class="code" href="class_main_window.html#aad2a51ad392a25d55d0fe6927bdd113f">00849</a> QSet&lt;QString&gt; <a class="code" href="class_main_window.html#aad2a51ad392a25d55d0fe6927bdd113f">MainWindow::collectAssignedMaterialNames</a>() {
<a name="l00850"></a>00850   QSet&lt;QString&gt; material_names;
<a name="l00851"></a>00851   QMutexLocker locker(&amp;<a class="code" href="class_main_window.html#a8248124ea53e3f8a59e9cdbd68f0c353">printable_objects_mutex_</a>);
<a name="l00852"></a>00852   <span class="keywordflow">foreach</span> (<a class="code" href="class_printable_object.html">PrintableObject</a>* <span class="keywordtype">object</span>, <a class="code" href="class_main_window.html#a2161c23e2b84b26d19c82faa2567d619" title="Each object in the scene.">printable_objects_</a>) {
<a name="l00853"></a>00853     material_names += <span class="keywordtype">object</span>-&gt;collectMaterialNames();
<a name="l00854"></a>00854   }
<a name="l00855"></a>00855   <span class="keywordflow">return</span> material_names;
<a name="l00856"></a>00856 }
<a name="l00857"></a>00857 
<a name="l00858"></a><a class="code" href="class_main_window.html#a4b3bf8d42d0fabf05e956403c59e2b2c">00858</a> <span class="keywordtype">void</span> <a class="code" href="class_main_window.html#a4b3bf8d42d0fabf05e956403c59e2b2c">MainWindow::selectObject</a>(<a class="code" href="class_printable_object.html">PrintableObject</a>* <span class="keywordtype">object</span>) {
<a name="l00859"></a>00859   <span class="keywordflow">if</span> (<a class="code" href="class_main_window.html#a2f996598d11f383730e14625b3d34edd" title="Object currently selected for editing (it has the handles!).">selected_object_</a> != <span class="keywordtype">object</span>) {
<a name="l00860"></a>00860     <span class="keywordflow">if</span> (!<span class="keywordtype">object</span>) {
<a name="l00861"></a>00861       <a class="code" href="class_main_window.html#a2f996598d11f383730e14625b3d34edd" title="Object currently selected for editing (it has the handles!).">selected_object_</a> = 0;
<a name="l00862"></a>00862     } <span class="keywordflow">else</span> {
<a name="l00863"></a>00863       <a class="code" href="class_main_window.html#a2f996598d11f383730e14625b3d34edd" title="Object currently selected for editing (it has the handles!).">selected_object_</a> = object;
<a name="l00864"></a>00864 <span class="comment">//      showPositionObjectsPanel();</span>
<a name="l00865"></a>00865     }
<a name="l00866"></a>00866   }
<a name="l00867"></a>00867 
<a name="l00868"></a>00868   <a class="code" href="class_main_window.html#adfab654511e443d02a0adc2d1910851c" title="Allows objects to be reoriented.">position_objects_panel_</a>-&gt;<a class="code" href="class_position_objects_panel.html#ac0dd6524c2ef455d4ab4ea4abee62c95">setSelectedObject</a>(<a class="code" href="class_main_window.html#a2f996598d11f383730e14625b3d34edd" title="Object currently selected for editing (it has the handles!).">selected_object_</a>);
<a name="l00869"></a>00869   <a class="code" href="class_main_window.html#ab2b954f1b53302af498f9f83948f3fa5" title="Allows objects to be given printing materials.">materials_panel_</a>-&gt;<a class="code" href="class_materials_panel.html#a7ec92dd6566526e46d1338b2b6dc30fa">setSelectedObject</a>(<a class="code" href="class_main_window.html#a2f996598d11f383730e14625b3d34edd" title="Object currently selected for editing (it has the handles!).">selected_object_</a>);
<a name="l00870"></a>00870 }
<a name="l00871"></a>00871 
<a name="l00872"></a><a class="code" href="class_main_window.html#afd3147cf6f897cdaf4c48f1afbe7e2fb">00872</a> <span class="keywordtype">void</span> <a class="code" href="class_main_window.html#afd3147cf6f897cdaf4c48f1afbe7e2fb">MainWindow::setAlwaysShowStartupInformation</a>(<span class="keywordtype">bool</span> show) {
<a name="l00873"></a>00873   QSettings settings;
<a name="l00874"></a>00874   settings.setValue(<a class="code" href="mainwindow_8cpp.html#a30721e11c6fda03a29293f88e2354778">kAlwaysShowStartupInformationSettingKey</a>, show);
<a name="l00875"></a>00875   <a class="code" href="class_main_window.html#a35466a70ed47252a0191168126a352a5">ui</a>-&gt;<a class="code" href="class_ui___main_window.html#aee94693280f9cd6efd003cdaa2ea10cd">actionShow_Information_at_Startup</a>-&gt;setChecked(show);
<a name="l00876"></a>00876 }
<a name="l00877"></a>00877 
<a name="l00878"></a><a class="code" href="class_main_window.html#a757eba9bb43a9041bbb6c3a8b46c4139">00878</a> <span class="keywordtype">void</span> <a class="code" href="class_main_window.html#a757eba9bb43a9041bbb6c3a8b46c4139">MainWindow::updateMaterialColorAssignments</a>() {
<a name="l00879"></a>00879   <span class="comment">// Sync the materials panel</span>
<a name="l00880"></a>00880   QSet&lt;QString&gt; assigned_materials = <a class="code" href="class_main_window.html#aad2a51ad392a25d55d0fe6927bdd113f">collectAssignedMaterialNames</a>();
<a name="l00881"></a>00881   <span class="keyword">const</span> QMap&lt;QString, QColor&gt;&amp; color_assignments
<a name="l00882"></a>00882       = <a class="code" href="class_main_window.html#ab2b954f1b53302af498f9f83948f3fa5" title="Allows objects to be given printing materials.">materials_panel_</a>-&gt;<a class="code" href="class_materials_panel.html#a25e4da4643e93dd247aee2b49156f8ac">updateAssignedMaterials</a>(assigned_materials);
<a name="l00883"></a>00883 
<a name="l00884"></a>00884   <span class="comment">// Based on assigned colors, set this object&#39;s subsets&#39; colors</span>
<a name="l00885"></a>00885   <span class="keywordflow">foreach</span> (<a class="code" href="class_printable_object.html">PrintableObject</a>* <span class="keywordtype">object</span>, <a class="code" href="class_main_window.html#a2161c23e2b84b26d19c82faa2567d619" title="Each object in the scene.">printable_objects_</a>) {
<a name="l00886"></a>00886     <span class="keywordflow">for</span> (QMap&lt;QString,QColor&gt;::const_iterator i = color_assignments.begin();
<a name="l00887"></a>00887                                               i != color_assignments.end();
<a name="l00888"></a>00888                                             ++i) {
<a name="l00889"></a>00889       <span class="keywordtype">object</span>-&gt;setRenderColor(i.key(), i.value());
<a name="l00890"></a>00890     }
<a name="l00891"></a>00891   }
<a name="l00892"></a>00892 
<a name="l00893"></a>00893   <span class="comment">// Redraw the screen since colors may have changed</span>
<a name="l00894"></a>00894   <a class="code" href="class_main_window.html#a807a36499c006fb8924b7f5d4257ec81">glRepaint</a>();
<a name="l00895"></a>00895 }
<a name="l00896"></a>00896 
<a name="l00897"></a>00897 
<a name="l00898"></a><a class="code" href="class_main_window.html#a2c15c6babe3a29a02953fb93caf85af8">00898</a> <span class="keywordtype">void</span> <a class="code" href="class_main_window.html#a2c15c6babe3a29a02953fb93caf85af8">MainWindow::on_actionEnable_Advanced_Features_triggered</a>() {
<a name="l00899"></a>00899   <a class="code" href="class_main_window.html#adfa362b12ec71954709543ca552f4279">useAdvancedMode</a>(<a class="code" href="class_main_window.html#a35466a70ed47252a0191168126a352a5">ui</a>-&gt;<a class="code" href="class_ui___main_window.html#a81eed404242ab88d58968e12c4e46356">actionEnable_Advanced_Features</a>-&gt;isChecked());
<a name="l00900"></a>00900 }
<a name="l00901"></a>00901 
<a name="l00902"></a><a class="code" href="class_main_window.html#a8dc402e36f106189418311baedffa9f9">00902</a> <span class="keywordtype">void</span> <a class="code" href="class_main_window.html#a8dc402e36f106189418311baedffa9f9">MainWindow::finishedLoadObjectFile</a>() {
<a name="l00903"></a>00903   <a class="code" href="class_main_window.html#ae63126f188819c07771852e0a4b91f6b" title="Provides ways of bringing objects into the scene.">load_objects_panel_</a>-&gt;setEnabled(<span class="keyword">true</span>);
<a name="l00904"></a>00904   <span class="keyword">delete</span> <a class="code" href="class_main_window.html#a981b1438f8c5de5a0c526737dff322a8" title="Current thread loading an object file.">load_object_file_thread_</a>;
<a name="l00905"></a>00905   <a class="code" href="class_main_window.html#a981b1438f8c5de5a0c526737dff322a8" title="Current thread loading an object file.">load_object_file_thread_</a> = 0;
<a name="l00906"></a>00906   <a class="code" href="class_main_window.html#a54ba01ddbe3978bf08e7cd70704682cf">showMaterialsPanel</a>();
<a name="l00907"></a>00907 }
<a name="l00908"></a>00908 
<a name="l00909"></a><a class="code" href="class_main_window.html#ab1b4afa30acceb39f2629ffe4133c979">00909</a> <span class="keywordtype">void</span> <a class="code" href="class_main_window.html#ab1b4afa30acceb39f2629ffe4133c979">MainWindow::on_actionVisit_FabAtHome_org_triggered</a>() {
<a name="l00910"></a>00910   <a class="code" href="todo_8h.html#ae61a00cdcabcd21f703f7ad228eb25db">todo</a>(<span class="stringliteral">&quot;kwg8&quot;</span>, <span class="stringliteral">&quot;do something (pop failure msg) if we can&#39;t open the website&quot;</span>);
<a name="l00911"></a>00911   QDesktopServices::openUrl(QUrl(<span class="stringliteral">&quot;http://www.fabathome.org/&quot;</span>));
<a name="l00912"></a>00912 }
<a name="l00913"></a>00913 
<a name="l00914"></a><a class="code" href="class_main_window.html#a17016617e98b7fbe27a8caa25dfc5620">00914</a> <span class="keywordtype">void</span> <a class="code" href="class_main_window.html#a17016617e98b7fbe27a8caa25dfc5620">MainWindow::on_actionAbout_FabStudio_triggered</a>() {
<a name="l00915"></a>00915   <a class="code" href="class_about_dialog.html">AboutDialog</a> dialog;
<a name="l00916"></a>00916   dialog.exec();
<a name="l00917"></a>00917 }
<a name="l00918"></a>00918 
<a name="l00919"></a><a class="code" href="class_main_window.html#ab4487c4b02224acd4a0193d38b704ddb">00919</a> <span class="keywordtype">void</span> <a class="code" href="class_main_window.html#ab4487c4b02224acd4a0193d38b704ddb">MainWindow::on_actionExit_triggered</a>() {
<a name="l00920"></a>00920   close();
<a name="l00921"></a>00921 }
<a name="l00922"></a>00922 
<a name="l00923"></a><a class="code" href="class_main_window.html#a9cf37de4551319613bf318a86e5fbf23">00923</a> <span class="keywordtype">void</span> <a class="code" href="class_main_window.html#a9cf37de4551319613bf318a86e5fbf23">MainWindow::on_actionShow_Information_at_Startup_triggered</a>() {
<a name="l00924"></a>00924   <a class="code" href="class_main_window.html#afd3147cf6f897cdaf4c48f1afbe7e2fb">setAlwaysShowStartupInformation</a>(<a class="code" href="class_main_window.html#a35466a70ed47252a0191168126a352a5">ui</a>-&gt;<a class="code" href="class_ui___main_window.html#aee94693280f9cd6efd003cdaa2ea10cd">actionShow_Information_at_Startup</a>-&gt;isChecked());
<a name="l00925"></a>00925 }
</pre></div></div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address style="text-align: right;"><small>Generated on Mon Apr 26 17:36:03 2010 for FabStudio by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
